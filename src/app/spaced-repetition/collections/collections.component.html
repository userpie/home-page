<div class="flashcard-arrays-container">
  <div class="header-section">
    <div class="header-content">
      <div class="title-group">
        <h2>Collection</h2>
        <p class="subtitle">Overview of all available collections</p>
      </div>
      <button type="button" class="glossy-btn" (click)="showAddForm.set(true)">
        <span class="btn-text">Create New</span>
        <div class="btn-shine"></div>
      </button>
    </div>
  </div>
  <!-- Rest of your existing content remains the same -->
  @if (!showAddForm()){
  <div class="arrays-list">
    @for (collectionMetadata of collectionsMetadata(); track collectionMetadata.id) {
      <div
        class="array-card"
        [class.selected]="isSelected(collectionMetadata.id)"
        (click)="selectArray(collectionMetadata.id)"
      >
        <div class="array-header">
          <div class="title-section">
            <h3>{{ collectionMetadata.name }}</h3>
            @if (isSelected(collectionMetadata.id)) {
              <span class="selected-badge">Selected</span>
            }
          </div>
          <span class="total-cards">{{ collectionMetadata.totalCards }} cards</span>
        </div>

        <div class="array-details">
          <p class="description">{{ collectionMetadata.description }}</p>

          <div class="statistics">
            <div class="stat-item">
              <span class="label">Average length:</span>
              <span class="value">{{ collectionMetadata.statistics.averageBackLength }}</span>
            </div>
            <div class="stat-item">
              <span class="label">Range:</span>
              <span class="value"
              >{{ collectionMetadata.statistics.minBackLength }} - {{ collectionMetadata.statistics.maxBackLength }}</span
              >
            </div>
          </div>

          <div class="length-distribution">
            <h4>Length Distribution:</h4>
            <div class="distribution-items">
              @for (item of getLengthDistributionEntries(collectionMetadata.lengthDistribution); track item.length) {
                <span class="distribution-item"> {{ item.length }}ch: {{ item.count }} </span>
              }
            </div>
          </div>

          @if (isSelected(collectionMetadata.id)) {
            <div class="action-section">
              <button type="button" class="start-study-btn" (click)="startStudying($event, collectionMetadata)">
                Start Studying This Array
              </button>
            </div>
          }
        </div>
      </div>
    }
  </div>
  } @else {
  <div class="add-array-form">
    <h3>Add New Collection</h3>
    <form [formGroup]="collectionForm" (ngSubmit)="addCollection()">
      <div class="form-group">
        <label for="name">Collection name</label>
        <input
          id="name"
          formControlName="name"
          placeholder="Enter a name for the collection"
          type="text"
          required
        />
        </div>
      <div class="form-group">
        <label for="description">Description</label>
        <textarea
          id="description"
          formControlName="description"
          placeholder="Enter a description for the collection"
          rows="3"
          required
        ></textarea>
        </div>

      <div class="form-actions">
        <button type="submit" [disabled]="collectionForm.invalid" class="btn btn-primary">Add Collection</button>
        <button type="button" (click)="cancelAddCollection()" class="btn btn-secondary">Cancel</button>
      </div>
    </form>
    </div>
  }

</div>
