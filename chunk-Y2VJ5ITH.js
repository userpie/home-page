import{a as Ct,c as vt,d as lt,g as gn}from"./chunk-B5FPFWUE.js";import{$a as ut,Ab as pn,Ba as Nt,Ca as V,Fb as Fe,Ga as $,Ha as Yt,Ia as U,K as $t,Ka as W,Kb as st,L as nt,M as it,Ma as dn,N as Wt,Ob as _t,P as dt,Pa as un,Qa as ft,Qb as Xt,R as k,Ta as N,Ua as T,Va as Ie,W as b,Wa as Q,X as x,Xa as X,Y as qt,Ya as w,Z as an,Za as l,_a as c,a as S,aa as sn,ab as A,b as P,bb as B,cb as hn,db as R,ea as O,eb as Zt,fb as C,ga as Ae,gb as K,h as en,ha as At,hb as p,ib as ht,ja as It,jb as H,k as nn,kb as Jt,lb as u,mb as m,na as gt,nb as E,ob as mt,p as rn,pb as rt,qb as Qt,rb as g,sa as ln,sb as f,ta as s,u as on,vb as ot,wb as L,xa as Ft,yb as at,za as cn,zb as q}from"./chunk-IMWBIHFV.js";var wn=(()=>{class i{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,n){this._renderer=e,this._elementRef=n}setProperty(e,n){this._renderer.setProperty(this._elementRef.nativeElement,e,n)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(n){return new(n||i)(V(Nt),V(It))};static \u0275dir=U({type:i})}return i})(),Le=(()=>{class i extends wn{static \u0275fac=(()=>{let e;return function(r){return(e||(e=At(i)))(r||i)}})();static \u0275dir=U({type:i,features:[W]})}return i})(),le=new dt("");var Kn={provide:le,useExisting:nt(()=>Mt),multi:!0};function ti(){let i=Fe()?Fe().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var ei=new dt(""),Mt=(()=>{class i extends wn{_compositionMode;_composing=!1;constructor(e,n,r){super(e,n),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!ti())}writeValue(e){let n=e??"";this.setProperty("value",n)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(n){return new(n||i)(V(Nt),V(It),V(ei,8))};static \u0275dir=U({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,r){n&1&&C("input",function(a){return r._handleInput(a.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(a){return r._compositionEnd(a.target.value)})},standalone:!1,features:[rt([Kn]),W]})}return i})();function Ue(i){return i==null||He(i)===0}function He(i){return i==null?null:Array.isArray(i)||typeof i=="string"?i.length:i instanceof Set?i.size:null}var ce=new dt(""),de=new dt(""),ni=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,G=class{static min(t){return ii(t)}static max(t){return ri(t)}static required(t){return oi(t)}static requiredTrue(t){return ai(t)}static email(t){return si(t)}static minLength(t){return li(t)}static maxLength(t){return ci(t)}static pattern(t){return di(t)}static nullValidator(t){return Sn()}static compose(t){return kn(t)}static composeAsync(t){return In(t)}};function ii(i){return t=>{if(t.value==null||i==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e<i?{min:{min:i,actual:t.value}}:null}}function ri(i){return t=>{if(t.value==null||i==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e>i?{max:{max:i,actual:t.value}}:null}}function oi(i){return Ue(i.value)?{required:!0}:null}function ai(i){return i.value===!0?null:{required:!0}}function si(i){return Ue(i.value)||ni.test(i.value)?null:{email:!0}}function li(i){return t=>{let e=t.value?.length??He(t.value);return e===null||e===0?null:e<i?{minlength:{requiredLength:i,actualLength:e}}:null}}function ci(i){return t=>{let e=t.value?.length??He(t.value);return e!==null&&e>i?{maxlength:{requiredLength:i,actualLength:e}}:null}}function di(i){if(!i)return Sn;let t,e;return typeof i=="string"?(e="",i.charAt(0)!=="^"&&(e+="^"),e+=i,i.charAt(i.length-1)!=="$"&&(e+="$"),t=new RegExp(e)):(e=i.toString(),t=i),n=>{if(Ue(n.value))return null;let r=n.value;return t.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}function Sn(i){return null}function On(i){return i!=null}function Pn(i){return dn(i)?nn(i):i}function Vn(i){let t={};return i.forEach(e=>{t=e!=null?S(S({},t),e):t}),Object.keys(t).length===0?null:t}function Dn(i,t){return t.map(e=>e(i))}function ui(i){return!i.validate}function En(i){return i.map(t=>ui(t)?t:e=>t.validate(e))}function kn(i){if(!i)return null;let t=i.filter(On);return t.length==0?null:function(e){return Vn(Dn(e,t))}}function An(i){return i!=null?kn(En(i)):null}function In(i){if(!i)return null;let t=i.filter(On);return t.length==0?null:function(e){let n=Dn(e,t).map(Pn);return on(n).pipe(rn(Vn))}}function Fn(i){return i!=null?In(En(i)):null}function fn(i,t){return i===null?[t]:Array.isArray(i)?[...i,t]:[i,t]}function Nn(i){return i._rawValidators}function Tn(i){return i._rawAsyncValidators}function Ne(i){return i?Array.isArray(i)?i:[i]:[]}function ee(i,t){return Array.isArray(i)?i.includes(t):i===t}function mn(i,t){let e=Ne(t);return Ne(i).forEach(r=>{ee(e,r)||e.push(r)}),e}function _n(i,t){return Ne(t).filter(e=>!ee(i,e))}var ne=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=An(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=Fn(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return this.control?this.control.hasError(t,e):!1}getError(t,e){return this.control?this.control.getError(t,e):null}},Y=class extends ne{name;get formDirective(){return null}get path(){return null}},Ut=class extends ne{_parent=null;name=null;valueAccessor=null},ie=class{_cd;constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},hi={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},no=P(S({},hi),{"[class.ng-submitted]":"isSubmitted"}),ue=(()=>{class i extends ie{constructor(e){super(e)}static \u0275fac=function(n){return new(n||i)(V(Ut,2))};static \u0275dir=U({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,r){n&2&&H("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[W]})}return i})(),he=(()=>{class i extends ie{constructor(e){super(e)}static \u0275fac=function(n){return new(n||i)(V(Y,10))};static \u0275dir=U({type:i,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,r){n&2&&H("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[W]})}return i})();var Tt="VALID",Kt="INVALID",yt="PENDING",Bt="DISABLED",ct=class{},re=class extends ct{value;source;constructor(t,e){super(),this.value=t,this.source=e}},Rt=class extends ct{pristine;source;constructor(t,e){super(),this.pristine=t,this.source=e}},Lt=class extends ct{touched;source;constructor(t,e){super(),this.touched=t,this.source=e}},bt=class extends ct{status;source;constructor(t,e){super(),this.status=t,this.source=e}},Te=class extends ct{source;constructor(t){super(),this.source=t}},Ht=class extends ct{source;constructor(t){super(),this.source=t}};function je(i){return(pe(i)?i.validators:i)||null}function pi(i){return Array.isArray(i)?An(i):i||null}function Ge(i,t){return(pe(t)?t.asyncValidators:i)||null}function gi(i){return Array.isArray(i)?Fn(i):i||null}function pe(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}function Bn(i,t,e){let n=i.controls;if(!(t?Object.keys(n):n).length)throw new $t(1e3,"");if(!n[e])throw new $t(1001,"")}function Rn(i,t,e){i._forEachChild((n,r)=>{if(e[r]===void 0)throw new $t(1002,"")})}var xt=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(t,e){this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return ot(this.statusReactive)}set status(t){ot(()=>this.statusReactive.set(t))}_status=L(()=>this.statusReactive());statusReactive=O(void 0);get valid(){return this.status===Tt}get invalid(){return this.status===Kt}get pending(){return this.status==yt}get disabled(){return this.status===Bt}get enabled(){return this.status!==Bt}errors;get pristine(){return ot(this.pristineReactive)}set pristine(t){ot(()=>this.pristineReactive.set(t))}_pristine=L(()=>this.pristineReactive());pristineReactive=O(!0);get dirty(){return!this.pristine}get touched(){return ot(this.touchedReactive)}set touched(t){ot(()=>this.touchedReactive.set(t))}_touched=L(()=>this.touchedReactive());touchedReactive=O(!1);get untouched(){return!this.touched}_events=new en;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(mn(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(mn(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(_n(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(_n(t,this._rawAsyncValidators))}hasValidator(t){return ee(this._rawValidators,t)}hasAsyncValidator(t){return ee(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){let e=this.touched===!1;this.touched=!0;let n=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched(P(S({},t),{sourceControl:n})),e&&t.emitEvent!==!1&&this._events.next(new Lt(!0,n))}markAllAsDirty(t={}){this.markAsDirty({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsDirty(t))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=t.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:n})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,n),e&&t.emitEvent!==!1&&this._events.next(new Lt(!1,n))}markAsDirty(t={}){let e=this.pristine===!0;this.pristine=!1;let n=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty(P(S({},t),{sourceControl:n})),e&&t.emitEvent!==!1&&this._events.next(new Rt(!1,n))}markAsPristine(t={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=t.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,n),e&&t.emitEvent!==!1&&this._events.next(new Rt(!0,n))}markAsPending(t={}){this.status=yt;let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new bt(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending(P(S({},t),{sourceControl:e}))}disable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Bt,this.errors=null,this._forEachChild(r=>{r.disable(P(S({},t),{onlySelf:!0}))}),this._updateValue();let n=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new re(this.value,n)),this._events.next(new bt(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(P(S({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Tt,this._forEachChild(n=>{n.enable(P(S({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(P(S({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Tt||this.status===yt)&&this._runAsyncValidator(n,t.emitEvent)}let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new re(this.value,e)),this._events.next(new bt(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(P(S({},t),{sourceControl:e}))}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Bt:Tt}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=yt,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1,shouldHaveEmitted:t!==!1};let n=Pn(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let t=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(t){let e=t;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((n,r)=>n&&n._find(r),this)}getError(t,e){let n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,n){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||n)&&this._events.next(new bt(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,n)}_initObservables(){this.valueChanges=new Ft,this.statusChanges=new Ft}_calculateStatus(){return this._allControlsDisabled()?Bt:this.errors?Kt:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(yt)?yt:this._anyControlsHaveStatus(Kt)?Kt:Tt}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){let n=!this._anyControlsDirty(),r=this.pristine!==n;this.pristine=n,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),r&&this._events.next(new Rt(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new Lt(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_onDisabledChange=[];_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){pe(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let e=this._parent&&this._parent.dirty;return!t&&!!e&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=pi(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=gi(this._rawAsyncValidators)}},oe=class extends xt{constructor(t,e,n){super(je(e),Ge(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,n={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){Rn(this,!0,t),Object.keys(t).forEach(n=>{Bn(this,!0,n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(Object.keys(t).forEach(n=>{let r=this.controls[n];r&&r.patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t?t[r]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e),e?.emitEvent!==!1&&this._events.next(new Ht(this))}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,n)=>n._syncPendingControls()?!0:e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{let n=this.controls[e];n&&t(n,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[e,n]of Object.entries(this.controls))if(this.contains(e)&&t(n))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(e,n,r)=>((n.enabled||this.disabled)&&(e[r]=n.value),e))}_reduceChildren(t,e){let n=t;return this._forEachChild((r,o)=>{n=e(n,r,o)}),n}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var Be=class extends oe{};var ze=new dt("",{providedIn:"root",factory:()=>ge}),ge="always";function $e(i,t){return[...t.path,i]}function Cn(i,t,e=ge){We(i,t),t.valueAccessor.writeValue(i.value),(i.disabled||e==="always")&&t.valueAccessor.setDisabledState?.(i.disabled),mi(i,t),Ci(i,t),_i(i,t),fi(i,t)}function vn(i,t,e=!0){let n=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),se(i,t),i&&(t._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function ae(i,t){i.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function fi(i,t){if(t.valueAccessor.setDisabledState){let e=n=>{t.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(e),t._registerOnDestroy(()=>{i._unregisterOnDisabledChange(e)})}}function We(i,t){let e=Nn(i);t.validator!==null?i.setValidators(fn(e,t.validator)):typeof e=="function"&&i.setValidators([e]);let n=Tn(i);t.asyncValidator!==null?i.setAsyncValidators(fn(n,t.asyncValidator)):typeof n=="function"&&i.setAsyncValidators([n]);let r=()=>i.updateValueAndValidity();ae(t._rawValidators,r),ae(t._rawAsyncValidators,r)}function se(i,t){let e=!1;if(i!==null){if(t.validator!==null){let r=Nn(i);if(Array.isArray(r)&&r.length>0){let o=r.filter(a=>a!==t.validator);o.length!==r.length&&(e=!0,i.setValidators(o))}}if(t.asyncValidator!==null){let r=Tn(i);if(Array.isArray(r)&&r.length>0){let o=r.filter(a=>a!==t.asyncValidator);o.length!==r.length&&(e=!0,i.setAsyncValidators(o))}}}let n=()=>{};return ae(t._rawValidators,n),ae(t._rawAsyncValidators,n),e}function mi(i,t){t.valueAccessor.registerOnChange(e=>{i._pendingValue=e,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&Ln(i,t)})}function _i(i,t){t.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&Ln(i,t),i.updateOn!=="submit"&&i.markAsTouched()})}function Ln(i,t){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function Ci(i,t){let e=(n,r)=>{t.valueAccessor.writeValue(n),r&&t.viewToModelUpdate(n)};i.registerOnChange(e),t._registerOnDestroy(()=>{i._unregisterOnChange(e)})}function vi(i,t){i==null,We(i,t)}function yi(i,t){return se(i,t)}function bi(i,t){if(!i.hasOwnProperty("model"))return!1;let e=i.model;return e.isFirstChange()?!0:!Object.is(t,e.currentValue)}function xi(i){return Object.getPrototypeOf(i.constructor)===Le}function Mi(i,t){i._syncPendingControls(),t.forEach(e=>{let n=e.control;n.updateOn==="submit"&&n._pendingChange&&(e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function wi(i,t){if(!t)return null;Array.isArray(t);let e,n,r;return t.forEach(o=>{o.constructor===Mt?e=o:xi(o)?n=o:r=o}),r||n||e||null}function Si(i,t){let e=i.indexOf(t);e>-1&&i.splice(e,1)}function yn(i,t){let e=i.indexOf(t);e>-1&&i.splice(e,1)}function bn(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var te=class extends xt{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(t=null,e,n){super(je(e),Ge(n,e)),this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),pe(e)&&(e.nonNullable||e.initialValueIsDefault)&&(bn(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1,e?.emitEvent!==!1&&this._events.next(new Ht(this))}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){yn(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){yn(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){bn(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var Oi=i=>i instanceof te,Pi=(()=>{class i extends Y{_parent;ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return $e(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}static \u0275fac=(()=>{let e;return function(r){return(e||(e=At(i)))(r||i)}})();static \u0275dir=U({type:i,standalone:!1,features:[W]})}return i})();var fe=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=U({type:i,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return i})();var Un=new dt("");var Vi={provide:Y,useExisting:nt(()=>wt)},wt=(()=>{class i extends Y{callSetDisabledState;get submitted(){return ot(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}_submitted=L(()=>this._submittedReactive());_submittedReactive=O(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new Ft;constructor(e,n,r){super(),this.callSetDisabledState=r,this._setValidators(e),this._setAsyncValidators(n)}ngOnChanges(e){e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(se(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let n=this.form.get(e.path);return Cn(n,e,this.callSetDisabledState),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),n}getControl(e){return this.form.get(e.path)}removeControl(e){vn(e.control||null,e,!1),Si(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,n){this.form.get(e.path).setValue(n)}onSubmit(e){return this._submittedReactive.set(!0),Mi(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new Te(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0,n={}){this.form.reset(e,n),this._submittedReactive.set(!1)}_updateDomValue(){this.directives.forEach(e=>{let n=e.control,r=this.form.get(e.path);n!==r&&(vn(n||null,e),Oi(r)&&(Cn(r,e,this.callSetDisabledState),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let n=this.form.get(e.path);vi(n,e),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let n=this.form.get(e.path);n&&yi(n,e)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){We(this.form,this),this._oldForm&&se(this._oldForm,this)}static \u0275fac=function(n){return new(n||i)(V(ce,10),V(de,10),V(ze,8))};static \u0275dir=U({type:i,selectors:[["","formGroup",""]],hostBindings:function(n,r){n&1&&C("submit",function(a){return r.onSubmit(a)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[rt([Vi]),W,Ae]})}return i})(),Di={provide:Y,useExisting:nt(()=>Hn)},Hn=(()=>{class i extends Pi{name=null;constructor(e,n,r){super(),this._parent=e,this._setValidators(n),this._setAsyncValidators(r)}_checkParentType(){jn(this._parent)}static \u0275fac=function(n){return new(n||i)(V(Y,13),V(ce,10),V(de,10))};static \u0275dir=U({type:i,selectors:[["","formGroupName",""]],inputs:{name:[0,"formGroupName","name"]},standalone:!1,features:[rt([Di]),W]})}return i})(),Ei={provide:Y,useExisting:nt(()=>me)},me=(()=>{class i extends Y{_parent;name=null;constructor(e,n,r){super(),this._parent=e,this._setValidators(n),this._setAsyncValidators(r)}ngOnInit(){jn(this._parent),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective?.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return $e(this.name==null?this.name:this.name.toString(),this._parent)}static \u0275fac=function(n){return new(n||i)(V(Y,13),V(ce,10),V(de,10))};static \u0275dir=U({type:i,selectors:[["","formArrayName",""]],inputs:{name:[0,"formArrayName","name"]},standalone:!1,features:[rt([Ei]),W]})}return i})();function jn(i){return!(i instanceof Hn)&&!(i instanceof wt)&&!(i instanceof me)}var ki={provide:Ut,useExisting:nt(()=>jt)},jt=(()=>{class i extends Ut{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(e){}model;update=new Ft;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(e,n,r,o,a){super(),this._ngModelWarningConfig=a,this._parent=e,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=wi(this,o)}ngOnChanges(e){this._added||this._setUpControl(),bi(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return $e(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(n){return new(n||i)(V(Y,13),V(ce,10),V(de,10),V(le,10),V(Un,8))};static \u0275dir=U({type:i,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[rt([ki]),W,Ae]})}return i})();var Ai={provide:le,useExisting:nt(()=>_e),multi:!0};function Gn(i,t){return i==null?`${t}`:(t&&typeof t=="object"&&(t="Object"),`${i}: ${t}`.slice(0,50))}function Ii(i){return i.split(":")[0]}var _e=(()=>{class i extends Le{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;appRefInjector=k(un).injector;destroyRef=k(sn);cdr=k(pn);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,cn({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(e){this.cdr.markForCheck(),this.value=e;let n=this._getOptionId(e),r=Gn(n,e);this.setProperty("value",r)}registerOnChange(e){this.onChange=n=>{this.value=this._getOptionValue(n),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n),e))return n;return null}_getOptionValue(e){let n=Ii(e);return this._optionMap.has(n)?this._optionMap.get(n):e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=At(i)))(r||i)}})();static \u0275dir=U({type:i,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,r){n&1&&C("change",function(a){return r.onChange(a.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[rt([Ai]),W]})}return i})(),Ce=(()=>{class i{_element;_renderer;_select;id;constructor(e,n,r){this._element=e,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){this._select!=null&&(this._select._optionMap.set(this.id,e),this._setElementValue(Gn(this.id,e)),this._select._writeValueAfterRender())}set value(e){this._setElementValue(e),this._select&&this._select._writeValueAfterRender()}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(n){return new(n||i)(V(It),V(Nt),V(_e,9))};static \u0275dir=U({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return i})(),Fi={provide:le,useExisting:nt(()=>zn),multi:!0};function xn(i,t){return i==null?`${t}`:(typeof t=="string"&&(t=`'${t}'`),t&&typeof t=="object"&&(t="Object"),`${i}: ${t}`.slice(0,50))}function Ni(i){return i.split(":")[0]}var zn=(()=>{class i extends Le{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){this.value=e;let n;if(Array.isArray(e)){let r=e.map(o=>this._getOptionId(o));n=(o,a)=>{o._setSelected(r.indexOf(a.toString())>-1)}}else n=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(n)}registerOnChange(e){this.onChange=n=>{let r=[],o=n.selectedOptions;if(o!==void 0){let a=o;for(let d=0;d<a.length;d++){let v=a[d],_=this._getOptionValue(v.value);r.push(_)}}else{let a=n.options;for(let d=0;d<a.length;d++){let v=a[d];if(v.selected){let _=this._getOptionValue(v.value);r.push(_)}}}this.value=r,e(r)}}_registerOption(e){let n=(this._idCounter++).toString();return this._optionMap.set(n,e),n}_getOptionId(e){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n)._value,e))return n;return null}_getOptionValue(e){let n=Ni(e);return this._optionMap.has(n)?this._optionMap.get(n)._value:e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=At(i)))(r||i)}})();static \u0275dir=U({type:i,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,r){n&1&&C("change",function(a){return r.onChange(a.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[rt([Fi]),W]})}return i})(),ve=(()=>{class i{_element;_renderer;_select;id;_value;constructor(e,n,r){this._element=e,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){this._select!=null&&(this._value=e,this._setElementValue(xn(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(xn(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(n){return new(n||i)(V(It),V(Nt),V(zn,9))};static \u0275dir=U({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return i})();var $n=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Yt({type:i});static \u0275inj=Wt({})}return i})(),Re=class extends xt{constructor(t,e,n){super(je(e),Ge(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){Array.isArray(t)?t.forEach(n=>{this.controls.push(n),this._registerControl(n)}):(this.controls.push(t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,n={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(t,e={}){let n=this._adjustIndex(t);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,n={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),e&&(this.controls.splice(r,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){Rn(this,!1,t),t.forEach((n,r)=>{Bn(this,!1,r),this.at(r).setValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(t.forEach((n,r)=>{this.at(r)&&this.at(r).patchValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e),e?.emitEvent!==!1&&this._events.next(new Ht(this))}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,n)=>n._syncPendingControls()?!0:e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(let t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}};function Mn(i){return!!i&&(i.asyncValidators!==void 0||i.validators!==void 0||i.updateOn!==void 0)}var ye=(()=>{class i{useNonNullable=!1;get nonNullable(){let e=new i;return e.useNonNullable=!0,e}group(e,n=null){let r=this._reduceControls(e),o={};return Mn(n)?o=n:n!==null&&(o.validators=n.validator,o.asyncValidators=n.asyncValidator),new oe(r,o)}record(e,n=null){let r=this._reduceControls(e);return new Be(r,n)}control(e,n,r){let o={};return this.useNonNullable?(Mn(n)?o=n:(o.validators=n,o.asyncValidators=r),new te(e,P(S({},o),{nonNullable:!0}))):new te(e,n,r)}array(e,n,r){let o=e.map(a=>this._createControl(a));return new Re(o,n,r)}_reduceControls(e){let n={};return Object.keys(e).forEach(r=>{n[r]=this._createControl(e[r])}),n}_createControl(e){if(e instanceof te)return e;if(e instanceof xt)return e;if(Array.isArray(e)){let n=e[0],r=e.length>1?e[1]:null,o=e.length>2?e[2]:null;return this.control(n,r,o)}else return this.control(e)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=it({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Wn=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:ze,useValue:e.callSetDisabledState??ge}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=Yt({type:i});static \u0275inj=Wt({imports:[$n]})}return i})(),St=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:Un,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:ze,useValue:e.callSetDisabledState??ge}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=Yt({type:i});static \u0275inj=Wt({imports:[$n]})}return i})();var Ot=class i{basePath=Ct.firstPath;getAssetUrl(t){let e=t.startsWith("/")?t.substring(1):t;return`${this.basePath}/${e}`}getBackgroundImageUrl(t){return`url('${this.getAssetUrl(t)}')`}getSearchIconUrl(){return this.getBackgroundImageUrl("assets/icons/searchicon.svg")}getEditIconUrl(){return this.getBackgroundImageUrl("assets/icons/edit-icon.svg")}getDeleteIconUrl(){return this.getBackgroundImageUrl("assets/icons/delete-icon.svg")}getHistoryIconUrl(){return this.getBackgroundImageUrl("assets/icons/history-icon.svg")}getResetIconUrl(){return this.getBackgroundImageUrl("assets/icons/reset-icon.svg")}getAddIconUrl(){return this.getBackgroundImageUrl("assets/icons/add-icon.svg")}getBelgiumFlagIconUrl(){return"assets/flags/belgium.svg"}getBrazilianFlagIconUrl(){return"assets/flags/brazil.svg"}getJamaicanFlagIconUrl(){return"assets/flags/jamaica.svg"}getStartIconUrl(){return this.getBackgroundImageUrl("assets/icons/start-icon.svg")}getStartAllIconUrl(){return this.getBackgroundImageUrl("assets/icons/start-all-icon.svg")}getStarIconUrl(){return this.getBackgroundImageUrl("assets/icons/star-icon.svg")}getMoreIconUrl(){return this.getBackgroundImageUrl("assets/icons/more-icon.svg")}static \u0275fac=function(e){return new(e||i)};static \u0275prov=it({token:i,factory:i.\u0275fac,providedIn:"root"})};var Vt=(e=>(e[e.BIG=0]="BIG",e[e.SMALL=1]="SMALL",e))(Vt||{}),Pt=class i{title=q.required();size=q(0);icon=q(null);backgroundColor=q(null);hoverColor=q(null);click=at();ButtonSize=Vt;handleClick(t){t.stopPropagation(),this.click.emit()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=$({type:i,selectors:[["app-button"]],hostVars:6,hostBindings:function(e,n){e&2&&ht("--icon-url",n.icon())("--background-color",n.backgroundColor())("--hoverColor",n.hoverColor())},inputs:{title:[1,"title"],size:[1,"size"],icon:[1,"icon"],backgroundColor:[1,"backgroundColor"],hoverColor:[1,"hoverColor"]},outputs:{click:"click"},decls:3,vars:10,consts:[["type","button",1,"button",3,"click","title"]],template:function(e,n){e&1&&(A(0,"button",0),K("click",function(o){return n.handleClick(o)}),A(1,"span"),u(2),B()()),e&2&&(H("has-icon",n.icon())("small",n.size()===n.ButtonSize.SMALL)("hover-color",n.hoverColor()),Zt("title",n.title()),s(),H("sr-only",n.icon()),s(),m(n.title()))},styles:[".button[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:16px;transition:all .2s ease;box-shadow:0 2px 4px #0000001a;background-color:var(--background-color)}.button.small[_ngcontent-%COMP%]{width:32px;height:32px;font-size:14px}.button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 8px #00000026}.button[_ngcontent-%COMP%]:active{transform:translateY(0)}.button.hover-color[_ngcontent-%COMP%]:hover{background-color:var(--hoverColor)}.button[_ngcontent-%COMP%]:not(.hover-color):hover{filter:brightness(95%)}.button.has-icon[_ngcontent-%COMP%]{background-image:var(--icon-url);background-repeat:no-repeat;background-position:center;background-size:18px 18px}.button.has-icon.small[_ngcontent-%COMP%]{background-size:16px 16px}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}"]})};var y=(i=>(i[i.New=0]="New",i[i.Learning=1]="Learning",i[i.Review=2]="Review",i[i.Relearning=3]="Relearning",i))(y||{}),h=(i=>(i[i.Manual=0]="Manual",i[i.Again=1]="Again",i[i.Hard=2]="Hard",i[i.Good=3]="Good",i[i.Easy=4]="Easy",i))(h||{}),M=class i{static card(t){return P(S({},t),{state:i.state(t.state),due:i.time(t.due),last_review:t.last_review?i.time(t.last_review):void 0})}static rating(t){if(typeof t=="string"){let e=t.charAt(0).toUpperCase(),n=t.slice(1).toLowerCase(),r=h[`${e}${n}`];if(r===void 0)throw new Error(`Invalid rating:[${t}]`);return r}else if(typeof t=="number")return t;throw new Error(`Invalid rating:[${t}]`)}static state(t){if(typeof t=="string"){let e=t.charAt(0).toUpperCase(),n=t.slice(1).toLowerCase(),r=y[`${e}${n}`];if(r===void 0)throw new Error(`Invalid state:[${t}]`);return r}else if(typeof t=="number")return t;throw new Error(`Invalid state:[${t}]`)}static time(t){let e=new Date(t);if(typeof t=="object"&&t!==null&&!Number.isNaN(Date.parse(t)||+e))return e;if(typeof t=="string"){let n=Date.parse(t);if(Number.isNaN(n))throw new Error(`Invalid date:[${t}]`);return new Date(n)}else if(typeof t=="number")return new Date(t);throw new Error(`Invalid date:[${t}]`)}static review_log(t){return P(S({},t),{due:i.time(t.due),rating:i.rating(t.rating),state:i.state(t.state),review:i.time(t.review)})}};Date.prototype.scheduler=function(i,t){return Z(this,i,t)};Date.prototype.diff=function(i,t){return Dt(this,i,t)};Date.prototype.format=function(){return Ti(this)};Date.prototype.dueFormat=function(i,t,e){return Bi(this,i,t,e)};function Z(i,t,e){return new Date(e?M.time(i).getTime()+t*24*60*60*1e3:M.time(i).getTime()+t*60*1e3)}function Dt(i,t,e){if(!i||!t)throw new Error("Invalid date");let n=M.time(i).getTime()-M.time(t).getTime(),r=0;switch(e){case"days":r=Math.floor(n/(1440*60*1e3));break;case"minutes":r=Math.floor(n/(60*1e3));break}return r}function Ti(i){let t=M.time(i),e=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),o=t.getHours(),a=t.getMinutes(),d=t.getSeconds();return`${e}-${zt(n)}-${zt(r)} ${zt(o)}:${zt(a)}:${zt(d)}`}function zt(i){return i<10?`0${i}`:`${i}`}var qe=[60,60,24,31,12],Ye=["second","min","hour","day","month","year"];function Bi(i,t,e,n=Ye){i=M.time(i),t=M.time(t),n.length!==Ye.length&&(n=Ye);let r=i.getTime()-t.getTime(),o=0;for(r/=1e3,o=0;o<qe.length&&!(r<qe[o]);o++)r/=qe[o];return`${Math.floor(r)}${e?n[o]:""}`}var Ri=Object.freeze([h.Again,h.Hard,h.Good,h.Easy]),Li=[{start:2.5,end:7,factor:.15},{start:7,end:20,factor:.1},{start:20,end:1/0,factor:.05}];function Ui(i,t,e){let n=1;for(let a of Li)n+=a.factor*Math.max(Math.min(i,a.end)-a.start,0);i=Math.min(i,e);let r=Math.max(2,Math.round(i-n)),o=Math.min(Math.round(i+n),e);return i>t&&(r=Math.max(r,t+1)),r=Math.min(r,o),{min_ivl:r,max_ivl:o}}function z(i,t,e){return Math.min(Math.max(i,t),e)}function Hi(i,t){let e=Date.UTC(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()),n=Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate());return Math.floor((n-e)/864e5)}var ji=i=>{let t=i.slice(-1),e=parseInt(i.slice(0,-1),10);if(Number.isNaN(e)||!Number.isFinite(e)||e<0)throw new Error(`Invalid step value: ${i}`);switch(t){case"m":return e;case"h":return e*60;case"d":return e*1440;default:throw new Error(`Invalid step unit: ${i}, expected m/h/d`)}},Gi=(i,t,e)=>{let n=t===y.Relearning||t===y.Review?i.relearning_steps:i.learning_steps,r=n.length;if(r===0||e>=r)return{};let o=n[0],a=ji,d=()=>a(o),v=()=>{if(r===1)return Math.round(a(o)*1.5);let F=n[1];return Math.round((a(o)+a(F))/2)},_=F=>F<0||F>=r?null:n[F],D=F=>a(F),I={},j=_(Math.max(0,e));if(t===y.Review)return I[h.Again]={scheduled_minutes:a(j),next_step:0},I;{I[h.Again]={scheduled_minutes:d(),next_step:0},I[h.Hard]={scheduled_minutes:v(),next_step:e};let F=_(e+1);if(F){let et=D(F);et&&(I[h.Good]={scheduled_minutes:Math.round(et),next_step:e+1})}}return I};function zi(){let i=this.review_time.getTime(),t=this.current.reps,e=this.current.difficulty*this.current.stability;return`${i}_${t}_${e}`}var Oe=(i=>(i.SCHEDULER="Scheduler",i.LEARNING_STEPS="LearningSteps",i.SEED="Seed",i))(Oe||{}),xe=class{last;current;review_time;next=new Map;algorithm;strategies;elapsed_days=0;constructor(t,e,n,r){this.algorithm=n,this.last=M.card(t),this.current=M.card(t),this.review_time=M.time(e),this.strategies=r,this.init()}checkGrade(t){if(!Number.isFinite(t)||t<0||t>4)throw new Error(`Invalid grade "${t}",expected 1-4`)}init(){let{state:t,last_review:e}=this.current,n=0;t!==y.New&&e&&(n=Hi(e,this.review_time)),this.current.last_review=this.review_time,this.elapsed_days=n,this.current.elapsed_days=n,this.current.reps+=1;let r=zi;if(this.strategies){let o=this.strategies.get(Oe.SEED);o&&(r=o)}this.algorithm.seed=r.call(this)}preview(){return{[h.Again]:this.review(h.Again),[h.Hard]:this.review(h.Hard),[h.Good]:this.review(h.Good),[h.Easy]:this.review(h.Easy),[Symbol.iterator]:this.previewIterator.bind(this)}}*previewIterator(){for(let t of Ri)yield this.review(t)}review(t){let{state:e}=this.last,n;switch(this.checkGrade(t),e){case y.New:n=this.newState(t);break;case y.Learning:case y.Relearning:n=this.learningState(t);break;case y.Review:n=this.reviewState(t);break}return n}buildLog(t){let{last_review:e,due:n,elapsed_days:r}=this.last;return{rating:t,state:this.current.state,due:e||n,stability:this.current.stability,difficulty:this.current.difficulty,elapsed_days:this.elapsed_days,last_elapsed_days:r,scheduled_days:this.current.scheduled_days,learning_steps:this.current.learning_steps,review:this.review_time}}},Je=class{c;s0;s1;s2;constructor(t){let e=$i();this.c=1,this.s0=e(" "),this.s1=e(" "),this.s2=e(" "),t==null&&(t=Date.now()),this.s0-=e(t),this.s0<0&&(this.s0+=1),this.s1-=e(t),this.s1<0&&(this.s1+=1),this.s2-=e(t),this.s2<0&&(this.s2+=1)}next(){let t=2091639*this.s0+this.c*23283064365386963e-26;return this.s0=this.s1,this.s1=this.s2,this.c=t|0,this.s2=t-this.c,this.s2}set state(t){this.c=t.c,this.s0=t.s0,this.s1=t.s1,this.s2=t.s2}get state(){return{c:this.c,s0:this.s0,s1:this.s1,s2:this.s2}}};function $i(){let i=4022871197;return function(e){e=String(e);for(let n=0;n<e.length;n++){i+=e.charCodeAt(n);let r=.02519603282416938*i;i=r>>>0,r-=i,r*=i,i=r>>>0,r-=i,i+=r*4294967296}return(i>>>0)*23283064365386963e-26}}function Wi(i){let t=new Je(i),e=()=>t.next();return e.int32=()=>t.next()*4294967296|0,e.double=()=>e()+(e()*2097152|0)*11102230246251565e-32,e.state=()=>t.state,e.importState=n=>(t.state=n,e),e}var qi="5.2.3",Yi=.9,Zi=36500,Ji=!1,Pe=!0,Qi=Object.freeze(["1m","10m"]),Xi=Object.freeze(["10m"]),uo=`v${qi} using FSRS-6.0`,J=.001;var be=100,Yn=.5,Ki=.1542,Zn=Object.freeze([.212,1.2931,2.3065,8.2956,6.4133,.8334,3.0194,.001,1.8722,.1666,.796,1.4835,.0614,.2629,1.6483,.6014,1.8729,.5425,.0912,.0658,Ki]),tr=2,er=(i,t=Pe)=>[[J,be],[J,be],[J,be],[J,be],[1,10],[.001,4],[.001,4],[.001,.75],[0,4.5],[0,.8],[.001,3.5],[.001,5],[.001,.25],[.001,.9],[0,4],[0,1],[1,6],[0,i],[0,i],[t?.01:0,.8],[.1,.8]],Ze=(i,t,e=Pe)=>{let n=tr;if(Math.max(0,t)>1){let o=-(Math.log(i[11])+Math.log(Math.pow(2,i[13])-1)+i[14]*.3)/t;n=z(+o.toFixed(8),.01,2)}return er(n,e).slice(0,i.length).map(([o,a],d)=>z(i[d]||0,o,a))};var tn=(i,t=0,e=Pe)=>{if(i===void 0)return[...Zn];switch(i.length){case 21:return Ze(Array.from(i),t,e);case 19:return console.debug("[FSRS-6]auto fill w from 19 to 21 length"),Ze(Array.from(i),t,e).concat([0,Yn]);case 17:{let n=Ze(Array.from(i),t,e);return n[4]=+(n[5]*2+n[4]).toFixed(8),n[5]=+(Math.log(n[5]*3+1)/3).toFixed(8),n[6]=+(n[6]+.5).toFixed(8),console.debug("[FSRS-6]auto fill w from 17 to 21 length"),n.concat([0,0,0,Yn])}default:return console.warn("[FSRS]Invalid parameters length, using default parameters"),[...Zn]}},Jn=i=>{let t=Array.isArray(i?.learning_steps)?i.learning_steps:Qi,e=Array.isArray(i?.relearning_steps)?i.relearning_steps:Xi,n=i?.enable_short_term??Pe,r=tn(i?.w,e.length,n);return{request_retention:i?.request_retention||Yi,maximum_interval:i?.maximum_interval||Zi,w:r,enable_fuzz:i?.enable_fuzz??Ji,enable_short_term:n,learning_steps:t,relearning_steps:e}};function pt(i,t){let e={due:i?M.time(i):new Date,stability:0,difficulty:0,elapsed_days:0,scheduled_days:0,reps:0,lapses:0,learning_steps:0,state:y.New,last_review:void 0};return t&&typeof t=="function"?t(e):e}var Qn=i=>{let t=typeof i=="number"?-i:-i[20],e=Math.exp(Math.pow(t,-1)*Math.log(.9))-1;return{decay:t,factor:+e.toFixed(8)}};function Qe(i,t,e){let{decay:n,factor:r}=Qn(i);return+Math.pow(1+r*t/e,n).toFixed(8)}var Xe=class{param;intervalModifier;_seed;constructor(t){this.param=new Proxy(Jn(t),this.params_handler_proxy()),this.intervalModifier=this.calculate_interval_modifier(this.param.request_retention),this.forgetting_curve=Qe.bind(this,this.param.w)}get interval_modifier(){return this.intervalModifier}set seed(t){this._seed=t}calculate_interval_modifier(t){if(t<=0||t>1)throw new Error("Requested retention rate should be in the range (0,1]");let{decay:e,factor:n}=Qn(this.param.w);return+((Math.pow(t,1/e)-1)/n).toFixed(8)}get parameters(){return this.param}set parameters(t){this.update_parameters(t)}params_handler_proxy(){let t=this;return{set:function(e,n,r){return n==="request_retention"&&Number.isFinite(r)?t.intervalModifier=t.calculate_interval_modifier(Number(r)):n==="w"&&(r=tn(r,e.relearning_steps.length,e.enable_short_term),t.forgetting_curve=Qe.bind(this,r),t.intervalModifier=t.calculate_interval_modifier(Number(e.request_retention))),Reflect.set(e,n,r),!0}}}update_parameters(t){let e=Jn(t);for(let n in e){let r=n;this.param[r]=e[r]}}init_stability(t){return Math.max(this.param.w[t-1],.1)}init_difficulty(t){return+(this.param.w[4]-Math.exp((t-1)*this.param.w[5])+1).toFixed(8)}apply_fuzz(t,e){if(!this.param.enable_fuzz||t<2.5)return Math.round(t);let r=Wi(this._seed)(),{min_ivl:o,max_ivl:a}=Ui(t,e,this.param.maximum_interval);return Math.floor(r*(a-o+1)+o)}next_interval(t,e){let n=Math.min(Math.max(1,Math.round(t*this.intervalModifier)),this.param.maximum_interval);return this.apply_fuzz(n,e)}linear_damping(t,e){return+(t*(10-e)/9).toFixed(8)}next_difficulty(t,e){let n=-this.param.w[6]*(e-3),r=t+this.linear_damping(n,t);return z(this.mean_reversion(this.init_difficulty(h.Easy),r),1,10)}mean_reversion(t,e){return+(this.param.w[7]*t+(1-this.param.w[7])*e).toFixed(8)}next_recall_stability(t,e,n,r){let o=h.Hard===r?this.param.w[15]:1,a=h.Easy===r?this.param.w[16]:1;return+z(e*(1+Math.exp(this.param.w[8])*(11-t)*Math.pow(e,-this.param.w[9])*(Math.exp((1-n)*this.param.w[10])-1)*o*a),J,36500).toFixed(8)}next_forget_stability(t,e,n){return+z(this.param.w[11]*Math.pow(t,-this.param.w[12])*(Math.pow(e+1,this.param.w[13])-1)*Math.exp((1-n)*this.param.w[14]),J,36500).toFixed(8)}next_short_term_stability(t,e){let n=Math.pow(t,-this.param.w[19])*Math.exp(this.param.w[17]*(e-3+this.param.w[18])),r=e>=3?Math.max(n,1):n;return+z(t*r,J,36500).toFixed(8)}forgetting_curve;next_state(t,e,n){let{difficulty:r,stability:o}=t??{difficulty:0,stability:0};if(e<0)throw new Error(`Invalid delta_t "${e}"`);if(n<0||n>4)throw new Error(`Invalid grade "${n}"`);if(r===0&&o===0)return{difficulty:z(this.init_difficulty(n),1,10),stability:this.init_stability(n)};if(n===0)return{difficulty:r,stability:o};if(r<1||o<J)throw new Error(`Invalid memory state { difficulty: ${r}, stability: ${o} }`);let a=this.forgetting_curve(e,o),d=this.next_recall_stability(r,o,a,n),v=this.next_forget_stability(r,o,a),_=this.next_short_term_stability(o,n),D=d;if(n===1){let[j,F]=[0,0];this.param.enable_short_term&&(j=this.param.w[17],F=this.param.w[18]);let et=o/Math.exp(j*F);D=z(+et.toFixed(8),J,v)}return e===0&&this.param.enable_short_term&&(D=_),{difficulty:this.next_difficulty(r,n),stability:D}}},Me=class extends xe{learningStepsStrategy;constructor(t,e,n,r){super(t,e,n,r);let o=Gi;if(this.strategies){let a=this.strategies.get(Oe.LEARNING_STEPS);a&&(o=a)}this.learningStepsStrategy=o}getLearningInfo(t,e){let n=this.algorithm.parameters;t.learning_steps=t.learning_steps||0;let r=this.learningStepsStrategy(n,t.state,this.current.state===y.Learning&&e!==h.Again&&e!==h.Hard?t.learning_steps+1:t.learning_steps),o=Math.max(0,r[e]?.scheduled_minutes??0),a=Math.max(0,r[e]?.next_step??0);return{scheduled_minutes:o,next_steps:a}}applyLearningSteps(t,e,n){let{scheduled_minutes:r,next_steps:o}=this.getLearningInfo(this.current,e);if(r>0&&r<1440)t.learning_steps=o,t.scheduled_days=0,t.state=n,t.due=Z(this.review_time,Math.round(r),!1);else if(t.state=y.Review,r>=1440)t.learning_steps=o,t.due=Z(this.review_time,Math.round(r),!1),t.scheduled_days=Math.floor(r/1440);else{t.learning_steps=0;let a=this.algorithm.next_interval(t.stability,this.elapsed_days);t.scheduled_days=a,t.due=Z(this.review_time,a,!0)}}newState(t){let e=this.next.get(t);if(e)return e;let n=M.card(this.current);n.difficulty=z(this.algorithm.init_difficulty(t),1,10),n.stability=this.algorithm.init_stability(t),this.applyLearningSteps(n,t,y.Learning);let r={card:n,log:this.buildLog(t)};return this.next.set(t,r),r}learningState(t){let e=this.next.get(t);if(e)return e;let{state:n,difficulty:r,stability:o}=this.last,a=M.card(this.current);a.difficulty=this.algorithm.next_difficulty(r,t),a.stability=this.algorithm.next_short_term_stability(o,t),this.applyLearningSteps(a,t,n);let d={card:a,log:this.buildLog(t)};return this.next.set(t,d),d}reviewState(t){let e=this.next.get(t);if(e)return e;let n=this.elapsed_days,{difficulty:r,stability:o}=this.last,a=this.algorithm.forgetting_curve(n,o),d=M.card(this.current),v=M.card(this.current),_=M.card(this.current),D=M.card(this.current);this.next_ds(d,v,_,D,r,o,a),this.next_interval(v,_,D,n),this.next_state(v,_,D),this.applyLearningSteps(d,h.Again,y.Relearning),d.lapses+=1;let I={card:d,log:this.buildLog(h.Again)},j={card:v,log:super.buildLog(h.Hard)},F={card:_,log:super.buildLog(h.Good)},et={card:D,log:super.buildLog(h.Easy)};return this.next.set(h.Again,I),this.next.set(h.Hard,j),this.next.set(h.Good,F),this.next.set(h.Easy,et),this.next.get(t)}next_ds(t,e,n,r,o,a,d){t.difficulty=this.algorithm.next_difficulty(o,h.Again);let v=a/Math.exp(this.algorithm.parameters.w[17]*this.algorithm.parameters.w[18]),_=this.algorithm.next_forget_stability(o,a,d);t.stability=z(+v.toFixed(8),J,_),e.difficulty=this.algorithm.next_difficulty(o,h.Hard),e.stability=this.algorithm.next_recall_stability(o,a,d,h.Hard),n.difficulty=this.algorithm.next_difficulty(o,h.Good),n.stability=this.algorithm.next_recall_stability(o,a,d,h.Good),r.difficulty=this.algorithm.next_difficulty(o,h.Easy),r.stability=this.algorithm.next_recall_stability(o,a,d,h.Easy)}next_interval(t,e,n,r){let o,a;o=this.algorithm.next_interval(t.stability,r),a=this.algorithm.next_interval(e.stability,r),o=Math.min(o,a),a=Math.max(a,o+1);let d=Math.max(this.algorithm.next_interval(n.stability,r),a+1);t.scheduled_days=o,t.due=Z(this.review_time,o,!0),e.scheduled_days=a,e.due=Z(this.review_time,a,!0),n.scheduled_days=d,n.due=Z(this.review_time,d,!0)}next_state(t,e,n){t.state=y.Review,t.learning_steps=0,e.state=y.Review,e.learning_steps=0,n.state=y.Review,n.learning_steps=0}},we=class extends xe{newState(t){let e=this.next.get(t);if(e)return e;this.current.scheduled_days=0,this.current.elapsed_days=0;let n=M.card(this.current),r=M.card(this.current),o=M.card(this.current),a=M.card(this.current);return this.init_ds(n,r,o,a),this.next_interval(n,r,o,a,0),this.next_state(n,r,o,a),this.update_next(n,r,o,a),this.next.get(t)}init_ds(t,e,n,r){t.difficulty=z(this.algorithm.init_difficulty(h.Again),1,10),t.stability=this.algorithm.init_stability(h.Again),e.difficulty=z(this.algorithm.init_difficulty(h.Hard),1,10),e.stability=this.algorithm.init_stability(h.Hard),n.difficulty=z(this.algorithm.init_difficulty(h.Good),1,10),n.stability=this.algorithm.init_stability(h.Good),r.difficulty=z(this.algorithm.init_difficulty(h.Easy),1,10),r.stability=this.algorithm.init_stability(h.Easy)}learningState(t){return this.reviewState(t)}reviewState(t){let e=this.next.get(t);if(e)return e;let n=this.elapsed_days,{difficulty:r,stability:o}=this.last,a=this.algorithm.forgetting_curve(n,o),d=M.card(this.current),v=M.card(this.current),_=M.card(this.current),D=M.card(this.current);return this.next_ds(d,v,_,D,r,o,a),this.next_interval(d,v,_,D,n),this.next_state(d,v,_,D),d.lapses+=1,this.update_next(d,v,_,D),this.next.get(t)}next_ds(t,e,n,r,o,a,d){t.difficulty=this.algorithm.next_difficulty(o,h.Again);let v=this.algorithm.next_forget_stability(o,a,d);t.stability=z(a,J,v),e.difficulty=this.algorithm.next_difficulty(o,h.Hard),e.stability=this.algorithm.next_recall_stability(o,a,d,h.Hard),n.difficulty=this.algorithm.next_difficulty(o,h.Good),n.stability=this.algorithm.next_recall_stability(o,a,d,h.Good),r.difficulty=this.algorithm.next_difficulty(o,h.Easy),r.stability=this.algorithm.next_recall_stability(o,a,d,h.Easy)}next_interval(t,e,n,r,o){let a,d,v,_;a=this.algorithm.next_interval(t.stability,o),d=this.algorithm.next_interval(e.stability,o),v=this.algorithm.next_interval(n.stability,o),_=this.algorithm.next_interval(r.stability,o),a=Math.min(a,d),d=Math.max(d,a+1),v=Math.max(v,d+1),_=Math.max(_,v+1),t.scheduled_days=a,t.due=Z(this.review_time,a,!0),e.scheduled_days=d,e.due=Z(this.review_time,d,!0),n.scheduled_days=v,n.due=Z(this.review_time,v,!0),r.scheduled_days=_,r.due=Z(this.review_time,_,!0)}next_state(t,e,n,r){t.state=y.Review,t.learning_steps=0,e.state=y.Review,e.learning_steps=0,n.state=y.Review,n.learning_steps=0,r.state=y.Review,r.learning_steps=0}update_next(t,e,n,r){let o={card:t,log:this.buildLog(h.Again)},a={card:e,log:super.buildLog(h.Hard)},d={card:n,log:super.buildLog(h.Good)},v={card:r,log:super.buildLog(h.Easy)};this.next.set(h.Again,o),this.next.set(h.Hard,a),this.next.set(h.Good,d),this.next.set(h.Easy,v)}},Ke=class{fsrs;constructor(t){this.fsrs=t}replay(t,e,n){return this.fsrs.next(t,e,n)}handleManualRating(t,e,n,r,o,a,d){if(typeof e>"u")throw new Error("reschedule: state is required for manual rating");let v,_;if(e===y.New)v={rating:h.Manual,state:e,due:d??n,stability:t.stability,difficulty:t.difficulty,elapsed_days:r,last_elapsed_days:t.elapsed_days,scheduled_days:t.scheduled_days,learning_steps:t.learning_steps,review:n},_=pt(n),_.last_review=n;else{if(typeof d>"u")throw new Error("reschedule: due is required for manual rating");let D=Dt(d,n,"days");v={rating:h.Manual,state:t.state,due:t.last_review||t.due,stability:t.stability,difficulty:t.difficulty,elapsed_days:r,last_elapsed_days:t.elapsed_days,scheduled_days:t.scheduled_days,learning_steps:t.learning_steps,review:n},_=P(S({},t),{state:e,due:d,last_review:n,stability:o||t.stability,difficulty:a||t.difficulty,elapsed_days:r,scheduled_days:D,reps:t.reps+1})}return{card:_,log:v}}reschedule(t,e){let n=[],r=pt(t.due);for(let o of e){let a;if(o.review=M.time(o.review),o.rating===h.Manual){let d=0;r.state!==y.New&&r.last_review&&(d=Dt(o.review,r.last_review,"days")),a=this.handleManualRating(r,o.state,o.review,d,o.stability,o.difficulty,o.due?M.time(o.due):void 0)}else a=this.replay(r,o.review,o.rating);n.push(a),r=a.card}return n}calculateManualRecord(t,e,n,r){if(!n)return null;let{card:o,log:a}=n,d=M.card(t);return d.due.getTime()===o.due.getTime()?null:(d.scheduled_days=Dt(o.due,d.due,"days"),this.handleManualRating(d,o.state,M.time(e),a.elapsed_days,r?o.stability:void 0,r?o.difficulty:void 0,o.due))}},Se=class extends Xe{strategyHandler=new Map;Scheduler;constructor(t){super(t);let{enable_short_term:e}=this.parameters;this.Scheduler=e?Me:we}params_handler_proxy(){let t=this;return{set:function(e,n,r){return n==="request_retention"&&Number.isFinite(r)?t.intervalModifier=t.calculate_interval_modifier(Number(r)):n==="enable_short_term"?t.Scheduler=r===!0?Me:we:n==="w"&&(r=tn(r,e.relearning_steps.length,e.enable_short_term),t.forgetting_curve=Qe.bind(this,r),t.intervalModifier=t.calculate_interval_modifier(Number(e.request_retention))),Reflect.set(e,n,r),!0}}}useStrategy(t,e){return this.strategyHandler.set(t,e),this}clearStrategy(t){return t?this.strategyHandler.delete(t):this.strategyHandler.clear(),this}getScheduler(t,e){let r=this.strategyHandler.get(Oe.SCHEDULER)||this.Scheduler;return new r(t,e,this,this.strategyHandler)}repeat(t,e,n){let o=this.getScheduler(t,e).preview();return n&&typeof n=="function"?n(o):o}next(t,e,n,r){let o=this.getScheduler(t,e),a=M.rating(n);if(a===h.Manual)throw new Error("Cannot review a manual rating");let d=o.review(a);return r&&typeof r=="function"?r(d):d}get_retrievability(t,e,n=!0){let r=M.card(t);e=e?M.time(e):new Date;let o=r.state!==y.New?Math.max(Dt(e,r.last_review,"days"),0):0,a=r.state!==y.New?this.forgetting_curve(o,+r.stability.toFixed(8)):0;return n?`${(a*100).toFixed(2)}%`:a}rollback(t,e,n){let r=M.card(t),o=M.review_log(e);if(o.rating===h.Manual)throw new Error("Cannot rollback a manual rating");let a,d,v;switch(o.state){case y.New:a=o.due,d=void 0,v=0;break;case y.Learning:case y.Relearning:case y.Review:a=o.review,d=o.due,v=r.lapses-(o.rating===h.Again&&o.state===y.Review?1:0);break}let _=P(S({},r),{due:a,stability:o.stability,difficulty:o.difficulty,elapsed_days:o.last_elapsed_days,scheduled_days:o.scheduled_days,reps:Math.max(0,r.reps-1),lapses:Math.max(0,v),learning_steps:o.learning_steps,state:o.state,last_review:d});return n&&typeof n=="function"?n(_):_}forget(t,e,n=!1,r){let o=M.card(t);e=M.time(e);let a=o.state===y.New?0:Dt(e,o.due,"days"),d={rating:h.Manual,state:o.state,due:o.due,stability:o.stability,difficulty:o.difficulty,elapsed_days:0,last_elapsed_days:o.elapsed_days,scheduled_days:a,learning_steps:o.learning_steps,review:e},_={card:P(S({},o),{due:e,stability:0,difficulty:0,elapsed_days:0,scheduled_days:0,reps:n?0:o.reps,lapses:n?0:o.lapses,learning_steps:0,state:y.New,last_review:o.last_review}),log:d};return r&&typeof r=="function"?r(_):_}reschedule(t,e=[],n={}){let{recordLogHandler:r,reviewsOrderBy:o,skipManual:a=!0,now:d=new Date,update_memory_state:v=!1}=n;o&&typeof o=="function"&&e.sort(o),a&&(e=e.filter(et=>et.rating!==h.Manual));let _=new Ke(this),D=_.reschedule(n.first_card||pt(),e),I=D.length,j=M.card(t),F=_.calculateManualRecord(j,d,I?D[I-1]:void 0,v);return r&&typeof r=="function"?{collections:D.map(r),reschedule_item:F?r(F):null}:{collections:D,reschedule_item:F}}};var Et=class i{http=k(Xt);platformId=k(gt);translate=k(vt);isBrowser=_t(this.platformId);_collectionsMetadata=O([]);_isLoading=O(!0);collectionsMetadata=this._collectionsMetadata.asReadonly();isLoading=this._isLoading.asReadonly();constructor(){this.loadCollections()}loadCollections(){if(!this.isBrowser){this._isLoading.set(!1);return}let t=localStorage.getItem("collection-metadata");if(t)try{let n=JSON.parse(t).map(r=>P(S({},r),{starred:r.starred??!1}));this._collectionsMetadata.set(n),this.recalculateAllDueCards(),this._isLoading.set(!1)}catch(e){console.error("Error loading collection metadata:",e),this.loadDefaultCollections()}else this.loadDefaultCollections()}loadDefaultCollections(){this.http.get(Ct.firstPath+"/assets/spaced-repetition/collection-metadata.json").subscribe({next:t=>{let e=t.map(n=>P(S({},n),{starred:n.starred??!1}));this._collectionsMetadata.set(e),this.saveToLocalStorage(),this.recalculateAllDueCards(),this._isLoading.set(!1)},error:t=>{console.error("Error loading default collections:",t),this._isLoading.set(!1)}})}saveToLocalStorage(){if(!this.isBrowser)return;let t=this._collectionsMetadata();t.length>0&&localStorage.setItem("collection-metadata",JSON.stringify(t))}addCollection(t){let e=P(S({},t),{id:crypto.randomUUID(),createdAt:new Date().toISOString()});return this._collectionsMetadata.update(n=>[...n,e]),this.saveToLocalStorage(),e}updateCollection(t,e){return this._collectionsMetadata().findIndex(o=>o.id===t)===-1?!1:(this._collectionsMetadata.update(o=>o.map(a=>a.id===t?S(S({},a),e):a)),this.saveToLocalStorage(),!0)}deleteCollection(t){return this._collectionsMetadata().some(r=>r.id===t)?(this._collectionsMetadata.update(r=>r.filter(o=>o.id!==t)),this.isBrowser&&localStorage.removeItem(t),this.saveToLocalStorage(),!0):!1}getCollection(t){return this._collectionsMetadata().find(e=>e.id===t)}getCollections(t){return this._collectionsMetadata().filter(n=>t.includes(n.id))}updateCollectionStats(t,e){let n=e.filter(I=>I.collection===t);if(n.length===0)return;let r=n.map(I=>I.back.length),o=n.length,a=r.reduce((I,j)=>I+j,0)/o,d=Math.min(...r),v=Math.max(...r),_={};r.forEach(I=>{let j=I.toString();_[j]=(_[j]||0)+1});let D=this.calculateDueCards(t);this.updateCollection(t,{totalCards:o,dueCards:D,lengthDistribution:_,statistics:{averageBackLength:Math.round(a*100)/100,minBackLength:d,maxBackLength:v}})}resetToDefaults(){if(!this.isBrowser)return;localStorage.removeItem("collection-metadata"),this._collectionsMetadata().forEach(e=>{localStorage.removeItem(e.id)});for(let e=localStorage.length-1;e>=0;e--){let n=localStorage.key(e);n&&(n.startsWith("flashcards-")||n.includes("collection"))&&localStorage.removeItem(n)}this._collectionsMetadata.set([]),this.loadDefaultCollections()}searchCollections(t){if(!t.trim())return this._collectionsMetadata();let e=t.toLowerCase().trim();return this._collectionsMetadata().filter(n=>n.name.toLowerCase().includes(e)||n.description.toLowerCase().includes(e)||n.labels?.some(r=>r.toLowerCase().includes(e))||n.path&&this.translate.instant("flashcards.default-label").toLowerCase().includes(e))}calculateDueCards(t){if(!this.isBrowser)return 0;let e=this.getCollection(t);if(!e)return 0;let n=localStorage.getItem(t);if(n)try{let r=new Date;return JSON.parse(n).map(a=>({fsrsCard:{state:a.fsrsCard.state,due:new Date(a.fsrsCard.due)}})).filter(a=>a.fsrsCard.state===y.New||a.fsrsCard.due<=r).length}catch(r){return console.error("Error calculating due cards:",r),e.totalCards}else return e.totalCards}recalculateAllDueCards(){this.isBrowser&&(this._collectionsMetadata.update(t=>t.map(e=>P(S({},e),{dueCards:this.calculateDueCards(e.id)}))),this.saveToLocalStorage())}sortCollections(t,e,n,r=!1){return[...t].sort((o,a)=>{if(r){if(o.starred&&!a.starred)return-1;if(!o.starred&&a.starred)return 1}let d=0;switch(e){case"createdAt":let v=new Date(o.createdAt).getTime(),_=new Date(a.createdAt).getTime();d=v-_;break;case"name":d=o.name.localeCompare(a.name);break;case"totalCards":d=o.totalCards-a.totalCards;break;case"dueCards":let D=o.dueCards??o.totalCards,I=a.dueCards??a.totalCards;d=D-I;break;case"wordLength":let j=o.statistics?.averageBackLength??0,F=a.statistics?.averageBackLength??0;d=j-F;break}return n==="asc"?d:-d})}static \u0275fac=function(e){return new(e||i)};static \u0275prov=it({token:i,factory:i.\u0275fac,providedIn:"root"})};var kt=class i{starred=q(!1);toggle=at();onHostClick(t){t.stopPropagation()}onToggle(){this.toggle.emit()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=$({type:i,selectors:[["app-star-button"]],hostVars:2,hostBindings:function(e,n){e&1&&C("click",function(o){return n.onHostClick(o)}),e&2&&H("starred",n.starred())},inputs:{starred:[1,"starred"]},outputs:{toggle:"toggle"},decls:3,vars:3,consts:[["type","button",1,"star-button",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",1,"star-icon"],["d","M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"]],template:function(e,n){e&1&&(A(0,"button",0),K("click",function(){return n.onToggle()}),qt(),A(1,"svg",1),hn(2,"path",2),B()()),e&2&&(ft("aria-pressed",n.starred())("aria-label",n.starred()?"Remove from favorites":"Add to favorites"),s(2),ft("fill",n.starred()?"currentColor":"none"))},styles:[".star-button[_ngcontent-%COMP%]{background:transparent;border:none;cursor:pointer;padding:4px;display:inline-flex;align-items:center;justify-content:center;transition:transform .2s ease;margin:0}.star-button[_ngcontent-%COMP%]:hover{transform:scale(1.15)}.star-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.star-button[_ngcontent-%COMP%]   .star-icon[_ngcontent-%COMP%]{color:#ccc;transition:color .3s ease,fill .3s ease;display:block}.star-button[_ngcontent-%COMP%]:focus{outline:2px solid #4a90e2;outline-offset:2px;border-radius:4px}.starred[_nghost-%COMP%]   .star-icon[_ngcontent-%COMP%]{color:gold}"],changeDetection:0})};var nr=()=>[],ir=(i,t)=>t.id,rr=(i,t)=>t.length;function or(i,t){if(i&1){let e=R();l(0,"div",42)(1,"app-button",43),C("click",function(){b(e);let r=p().$implicit,o=p(2);return x(o.deleteCollection(r))}),c(),l(2,"app-button",43),C("click",function(){b(e);let r=p().$implicit,o=p(2);return x(o.editCollection(r))}),c(),l(3,"app-button",43),C("click",function(){b(e);let r=p().$implicit,o=p(2);return x(o.startStudying(r))}),c()(),l(4,"div",44)(5,"app-button",43),C("click",function(){b(e);let r=p().$implicit,o=p(2);return x(o.toggleExpandedActions(r.id))}),c(),l(6,"div",45)(7,"app-button",43),C("click",function(){b(e);let r=p().$implicit,o=p(2);return x(o.deleteCollection(r))}),c(),l(8,"app-button",43),C("click",function(){b(e);let r=p().$implicit,o=p(2);return x(o.editCollection(r))}),c(),l(9,"app-button",43),C("click",function(){b(e);let r=p().$implicit,o=p(2);return x(o.startStudying(r))}),c()()()}if(i&2){let e=p().$implicit,n=p(2);s(),w("title","Deleting Collection")("size",n.ButtonSize.SMALL)("icon",n.assetUrlService.getDeleteIconUrl())("backgroundColor","#f8d7da")("hoverColor","#f5c6cb"),s(),w("title","Edit Collection")("size",n.ButtonSize.SMALL)("icon",n.assetUrlService.getEditIconUrl())("backgroundColor","#fff3cd")("hoverColor","#ffeaa7"),s(),w("title","Start")("size",n.ButtonSize.SMALL)("icon",n.assetUrlService.getStartIconUrl())("backgroundColor","#d4edda")("hoverColor","#c3e6cb"),s(2),w("title","More Options")("size",n.ButtonSize.SMALL)("icon",n.assetUrlService.getMoreIconUrl())("backgroundColor","#e7f3ff")("hoverColor","#d0e7ff"),s(),H("expanded",n.isActionsExpanded(e.id)),s(),w("title","Deleting Collection")("size",n.ButtonSize.SMALL)("icon",n.assetUrlService.getDeleteIconUrl())("backgroundColor","#f8d7da")("hoverColor","#f5c6cb"),s(),w("title","Edit Collection")("size",n.ButtonSize.SMALL)("icon",n.assetUrlService.getEditIconUrl())("backgroundColor","#fff3cd")("hoverColor","#ffeaa7"),s(),w("title","Start")("size",n.ButtonSize.SMALL)("icon",n.assetUrlService.getStartIconUrl())("backgroundColor","#d4edda")("hoverColor","#c3e6cb")}}function ar(i,t){if(i&1&&(l(0,"p",49),u(1),c()),i&2){let e=t.$implicit,n=t.$index,r=p(4);ht("border-left-color",r.getLabelColor(n)),s(),m(e)}}function sr(i,t){if(i&1&&(l(0,"p",49),u(1),g(2,"translate"),c()),i&2){let e=p(2).$implicit,n=p(2);ht("border-left-color",n.getLabelColor((e.labels||Qt(5,nr)).length)),s(),E(" ",f(2,3,"flashcards.default-label")," ")}}function lr(i,t){if(i&1&&(l(0,"div",35)(1,"span",46),u(2),g(3,"translate"),c(),l(4,"div",47),Q(5,ar,2,3,"p",48,Ie),N(7,sr,3,6,"p",48),c()()),i&2){let e=p().$implicit;s(2),m(f(3,2,"flashcards.labels")),s(3),X(e.labels),s(2),T(e.path?7:-1)}}function cr(i,t){if(i&1&&(l(0,"span",50),u(1),c()),i&2){let e=t.$implicit,n=p(3);Jt(n.getDistributionItemColorClass(e.length)),s(),mt(" ",e.length," ch: ",e.count," ")}}function dr(i,t){if(i&1){let e=R();l(0,"div",28),C("click",function(){let r=b(e).$implicit,o=p(2);return x(o.toggleSelection(r.id))}),l(1,"div",29)(2,"div",30)(3,"app-star-button",25),C("toggle",function(){let r=b(e).$implicit,o=p(2);return x(o.toggleStarred(r))}),c(),l(4,"h3"),u(5),c()(),l(6,"div",31),N(7,or,10,37),l(8,"span",32),u(9),g(10,"translate"),c()()(),l(11,"div",33)(12,"p",34),u(13),c(),N(14,lr,8,4,"div",35),l(15,"div",36)(16,"div",37)(17,"span",38),u(18),g(19,"translate"),c(),l(20,"span",39),u(21),c()(),l(22,"div",37)(23,"span",38),u(24),g(25,"translate"),c(),l(26,"span",39),u(27),c()(),l(28,"div",37)(29,"span",38),u(30),g(31,"translate"),c(),l(32,"div",40),Q(33,cr,2,4,"span",41,rr),c()()()()()}if(i&2){let e=t.$implicit,n=p(2);H("selected",n.isSelected(e.id)),s(3),w("starred",e.starred),s(2),m(e.name),s(2),T(n.isSelected(e.id)?7:-1);let r=n.getDueCards(e);s(),H("all-done",r===0)("none-done",r===e.totalCards),s(),mt(" ",r," ",f(10,18,"flashcards.cards")," "),s(4),m(e.description),s(),T(e.path||e.labels&&e.labels.length>0?14:-1),s(4),m(f(19,20,"flashcards.range")),s(3),E(" ",e.statistics.minBackLength===e.statistics.maxBackLength?e.statistics.minBackLength:e.statistics.minBackLength+" - "+e.statistics.maxBackLength," "),s(3),m(f(25,22,"flashcards.total")),s(3),E("",e.totalCards," "),s(3),m(f(31,24,"flashcards.length-distribution")),s(3),X(n.getLengthDistributionEntries(e.lengthDistribution))}}function ur(i,t){if(i&1){let e=R();l(0,"div",7)(1,"div",8)(2,"div",9)(3,"input",10),g(4,"translate"),C("input",function(r){b(e);let o=p();return x(o.onSearchChange(r))}),c()(),l(5,"div",11)(6,"label",12),u(7),g(8,"translate"),c(),l(9,"select",13),C("change",function(r){b(e);let o=p();return x(o.onSortByChange(r))}),l(10,"option",14),u(11),g(12,"translate"),c(),l(13,"option",15),u(14),g(15,"translate"),c(),l(16,"option",16),u(17),g(18,"translate"),c(),l(19,"option",17),u(20),g(21,"translate"),c(),l(22,"option",18),u(23),g(24,"translate"),c()()(),l(25,"div",19)(26,"div",11)(27,"label",20),u(28),g(29,"translate"),c(),l(30,"select",21),C("change",function(r){b(e);let o=p();return x(o.onSortChange(r))}),l(31,"option",22),u(32),g(33,"translate"),c(),l(34,"option",23),u(35),g(36,"translate"),c()()(),l(37,"div",24)(38,"app-star-button",25),C("toggle",function(){b(e);let r=p();return x(r.starredFirst.set(!r.starredFirst()))}),c()()()()(),l(39,"div",26),Q(40,dr,35,26,"div",27,ir),c()}if(i&2){let e=p();s(3),w("placeholder",f(4,14,"flashcards.search-input-placeholder"))("value",e.searchQuery()),s(4),m(f(8,16,"flashcards.sort-by-select")),s(2),w("value",e.sortBy()),s(2),m(f(12,18,"flashcards.sort-by-created")),s(3),m(f(15,20,"flashcards.sort-by-name")),s(3),m(f(18,22,"flashcards.sort-by-total")),s(3),m(f(21,24,"flashcards.sort-by-due")),s(3),m(f(24,26,"flashcards.sort-by-word-length")),s(5),m(f(29,28,"flashcards.sort-select")),s(2),w("value",e.sortOrder()),s(2),m(f(33,30,"flashcards.sort-desc")),s(3),m(f(36,32,"flashcards.sort-asc")),s(3),w("starred",e.starredFirst()),s(2),X(e.filteredCollections())}}function hr(i,t){if(i&1){let e=R();l(0,"button",65),C("click",function(){b(e);let r=p().$index,o=p(2);return x(o.removeLabelField(r))}),u(1,"\xD7 "),c()}i&2&&ft("aria-label","Remove label field")}function pr(i,t){if(i&1&&(l(0,"div",56),ut(1,"input",63),g(2,"translate"),N(3,hr,2,1,"button",64),c()),i&2){let e=t.$index,n=p(2);s(),ht("border-left-color",n.getLabelColor(e))("border-left-width",3,"px"),w("formControlName",e)("placeholder",f(2,7,"flashcards.labels-input-placeholder")),s(2),T(n.labelsArray.length>1?3:-1)}}function gr(i,t){if(i&1){let e=R();l(0,"div",5)(1,"h3"),u(2),g(3,"translate"),c(),l(4,"form",51),C("ngSubmit",function(){b(e);let r=p();return x(r.addCollection())}),l(5,"div",52)(6,"label",53),u(7),g(8,"translate"),c(),ut(9,"input",54),g(10,"translate"),c(),l(11,"div",52)(12,"label"),u(13),g(14,"translate"),c(),l(15,"div",55),Q(16,pr,4,9,"div",56,Ie),c(),l(18,"button",57),C("click",function(){b(e);let r=p();return x(r.addLabelField())}),u(19),g(20,"translate"),c()(),l(21,"div",52)(22,"label",58),u(23),g(24,"translate"),c(),l(25,"textarea",59),g(26,"translate"),u(27,"        "),c()(),l(28,"div",60)(29,"button",61),u(30),g(31,"translate"),c(),l(32,"button",62),C("click",function(){b(e);let r=p();return x(r.cancelAddCollection())}),u(33),g(34,"translate"),c()()()()}if(i&2){let e=p();s(2),m(f(3,12,e.editingCollectionId()?"flashcards.edit-collection":"flashcards.add-collection")),s(2),w("formGroup",e.collectionForm),s(3),m(f(8,14,"flashcards.collection-name")),s(2),w("placeholder",f(10,16,"flashcards.name-input-placeholder")),s(4),m(f(14,18,"flashcards.collection-labels")),s(3),X(e.labelsArray.controls),s(2),w("disabled",!e.canAddLabel()),s(),E(" + ",f(20,20,"flashcards.add-label-field")," "),s(4),m(f(24,22,"flashcards.description")),s(2),w("placeholder",f(26,24,"flashcards.desc-input-placeholder")),s(4),w("disabled",e.collectionForm.invalid),s(),E(" ",f(31,26,e.editingCollectionId()?"flashcards.confirm-edit-collection":"flashcards.confirm-add-collection")," "),s(3),E("",f(34,28,"common.cancel")," ")}}function fr(i,t){if(i&1){let e=R();l(0,"div",66),C("click",function(){b(e);let r=p();return x(r.hideResetModal())}),l(1,"div",67),C("click",function(r){return b(e),x(r.stopPropagation())}),l(2,"div",68)(3,"h3"),u(4),g(5,"translate"),c()(),l(6,"div",69)(7,"p"),u(8),g(9,"translate"),c(),l(10,"p"),u(11),g(12,"translate"),c()(),l(13,"div",70)(14,"button",71),C("click",function(){b(e);let r=p();return x(r.resetToDefaults())}),u(15),g(16,"translate"),c(),l(17,"button",62),C("click",function(){b(e);let r=p();return x(r.hideResetModal())}),u(18),g(19,"translate"),c()()()()}i&2&&(s(4),m(f(5,5,"flashcards.reset-modal.title")),s(4),m(f(9,7,"flashcards.reset-modal.message")),s(3),m(f(12,9,"flashcards.reset-modal.ask-confirm")),s(4),E(" ",f(16,11,"flashcards.reset-modal.confirm-button")," "),s(3),E(" ",f(19,13,"common.cancel")," "))}var Ve=class i{ButtonSize=Vt;fb=k(ye);assetUrlService=k(Ot);translate=k(vt);collectionsService=k(Et);selectedCollectionNumbers=O([]);showAddForm=O(!1);showResetModal=O(!1);searchQuery=O("");sortBy=O("dueCards");sortOrder=O("asc");starredFirst=O(!0);editingCollectionId=O(null);expandedActionsId=O(null);isLoading=this.collectionsService.isLoading;startStudyingCollection=at();filteredCollections=L(()=>{let t=this.searchQuery(),e=this.collectionsService.searchCollections(t);return this.collectionsService.sortCollections(e,this.sortBy(),this.sortOrder(),this.starredFirst())});globalMaxBackLength=L(()=>{let t=this.collectionsService.collectionsMetadata();return t.length===0?0:Math.max(...t.map(e=>e.statistics.maxBackLength))});collectionForm=this.fb.group({name:["",[G.required,G.maxLength(20)]],description:["",[G.maxLength(200)]],labels:this.fb.array([this.fb.control("",[G.maxLength(50)])])});ngOnInit(){this.collectionsService.recalculateAllDueCards()}get labelsArray(){return this.collectionForm.get("labels")}addLabelField(){this.labelsArray.push(this.fb.control("",[G.maxLength(50)]))}removeLabelField(t){this.labelsArray.length>1&&this.labelsArray.removeAt(t)}canAddLabel(){return this.labelsArray.controls.every(t=>t.value?.trim()!=="")}getLabelColor(t){let e=["#007bff","#28a745","#dc3545","#ffc107","#17a2b8","#6610f2","#e83e8c","#fd7e14","#20c997","#6f42c1"];return e[t%e.length]}getLengthDistributionEntries(t){return Object.entries(t).map(([e,n])=>({length:parseInt(e),count:n})).sort((e,n)=>e.length-n.length)}getDistributionItemColorClass(t){let e=this.globalMaxBackLength();if(e===0)return"";let n=e/3;return t<=n?"distribution-green":t<=n*2?"distribution-yellow":"distribution-red"}toggleSelection(t){this.isSelected(t)?(this.selectedCollectionNumbers.update(e=>e.filter(n=>n!==t)),this.expandedActionsId()===t&&this.expandedActionsId.set(null)):this.selectedCollectionNumbers.update(e=>[...e,t])}startStudying(t){this.startStudyingCollection.emit([t.id])}isSelected(t){return this.selectedCollectionNumbers().includes(t)}cancelAddCollection(){this.showAddForm.set(!1),this.collectionForm.reset(),this.labelsArray.clear(),this.labelsArray.push(this.fb.control("",[G.maxLength(50)])),this.editingCollectionId.set(null)}addCollection(){if(this.collectionForm.valid){let t=this.collectionForm.getRawValue(),e=this.editingCollectionId(),n=(t.labels||[]).filter(r=>r!==null&&r.trim()!=="");e?this.collectionsService.updateCollection(e,{name:t.name||"Untitled Collection",description:t.description||"",labels:n}):this.collectionsService.addCollection({name:t.name||"Untitled Collection",description:t.description||"",totalCards:0,lengthDistribution:{},statistics:{averageBackLength:0,minBackLength:0,maxBackLength:0},starred:!0,labels:n}),this.cancelAddCollection()}}onSearchChange(t){let e=t.target;this.searchQuery.set(e.value)}onSortByChange(t){let e=t.target;this.sortBy.set(e.value)}onSortChange(t){let e=t.target;this.sortOrder.set(e.value)}editCollection(t){this.collectionForm.patchValue({name:t.name,description:t.description}),this.labelsArray.clear(),t.labels&&t.labels.length>0?t.labels.forEach(e=>{this.labelsArray.push(this.fb.control(e,[G.maxLength(50)]))}):this.labelsArray.push(this.fb.control("",[G.maxLength(50)])),this.editingCollectionId.set(t.id),this.showAddForm.set(!0)}deleteCollection(t){confirm(this.translate.instant("flashcards.delete-modal.message",{collectionName:t.name}))&&(this.collectionsService.deleteCollection(t.id),this.selectedCollectionNumbers().includes(t.id)&&this.selectedCollectionNumbers.update(e=>e.filter(n=>n!==t.id)))}openResetModal(){this.showResetModal.set(!0)}hideResetModal(){this.showResetModal.set(!1)}resetToDefaults(){this.selectedCollectionNumbers.set([]),this.hideResetModal(),this.collectionsService.resetToDefaults()}startStudyingSelectedCollections(){this.startStudyingCollection.emit(this.selectedCollectionNumbers())}getDueCards(t){return t.dueCards??t.totalCards}toggleStarred(t){this.collectionsService.updateCollection(t.id,{starred:!t.starred})}toggleExpandedActions(t){this.expandedActionsId()===t?this.expandedActionsId.set(null):this.expandedActionsId.set(t)}isActionsExpanded(t){return this.expandedActionsId()===t}onDocumentClick(t){t.target.closest(".header-right")||this.expandedActionsId.set(null)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=$({type:i,selectors:[["app-collections"]],hostVars:2,hostBindings:function(e,n){e&1&&C("click",function(o){return n.onDocumentClick(o)},ln),e&2&&ht("--search-icon-url",n.assetUrlService.getSearchIconUrl())},outputs:{startStudyingCollection:"startStudyingCollection"},decls:10,vars:14,consts:[[1,"flashcard-arrays-container"],[1,"header-section"],[1,"header-content"],[1,"header-buttons"],[3,"click","title","icon","backgroundColor","hoverColor"],[1,"add-array-form"],[1,"modal-overlay"],[1,"search-section"],[1,"search-and-sort-container"],[1,"search-input-container"],["type","text",1,"search-input",3,"input","placeholder","value"],[1,"sort-container"],["for","sort-by-select",1,"sort-label"],["id","sort-by-select",1,"sort-select",3,"change","value"],["value","createdAt"],["value","name"],["value","totalCards"],["value","dueCards"],["value","wordLength"],[1,"controls-row"],["for","sort-select",1,"sort-label"],["id","sort-select",1,"sort-select",3,"change","value"],["value","desc"],["value","asc"],[1,"starred-filter-container"],[3,"toggle","starred"],[1,"arrays-list"],[1,"array-card",3,"selected"],[1,"array-card",3,"click"],[1,"array-header"],[1,"title-section"],[1,"header-right"],[1,"total-cards"],[1,"array-details"],[1,"description"],[1,"labels-section"],[1,"statistics"],[1,"stat-item"],[1,"label"],[1,"value"],[1,"distribution-items"],[1,"distribution-item",3,"class"],[1,"action-buttons"],[3,"click","title","size","icon","backgroundColor","hoverColor"],[1,"more-button-container"],[1,"mobile-action-buttons"],[1,"labels-label"],[1,"labels-list"],[1,"labels",3,"border-left-color"],[1,"labels"],[1,"distribution-item"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","name"],["id","name","formControlName","name","type","text",3,"placeholder"],["formArrayName","labels"],[1,"label-input-container"],["type","button",1,"btn-add-label",3,"click","disabled"],["for","description"],["id","description","formControlName","description","rows","3",3,"placeholder"],[1,"form-actions"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"],["type","text",3,"formControlName","placeholder"],["type","button",1,"btn-remove-label"],["type","button",1,"btn-remove-label",3,"click"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-body"],[1,"modal-actions"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(e,n){e&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-button",4),C("click",function(){return n.openResetModal()}),c(),l(5,"app-button",4),C("click",function(){return n.showAddForm.set(!0)}),c(),l(6,"app-button",4),C("click",function(){return n.startStudyingSelectedCollections()}),c()()()(),N(7,ur,42,34)(8,gr,35,30,"div",5),N(9,fr,20,15,"div",6),c()),e&2&&(s(4),w("title","Reset to Default Collections")("icon",n.assetUrlService.getResetIconUrl())("backgroundColor","#f8d7da")("hoverColor","#f5c6cb"),s(),w("title","Create New Collection")("icon",n.assetUrlService.getAddIconUrl())("backgroundColor","#fff3cd")("hoverColor","#ffeaa7"),s(),w("title","Start Selected Collections")("icon",n.assetUrlService.getStartAllIconUrl())("backgroundColor","#d4edda")("hoverColor","#c3e6cb"),s(),T(!n.showAddForm()&&!n.isLoading()?7:8),s(2),T(n.showResetModal()?9:-1))},dependencies:[st,Wn,fe,Ce,ve,Mt,ue,he,St,wt,jt,me,Pt,kt,lt],styles:[".flashcard-arrays-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 15px}.header-section[_ngcontent-%COMP%]{text-align:center;margin:0 -10px 20px;position:sticky;top:0;z-index:10;background-color:#fff;padding:1rem 0;box-shadow:0 4px 3px #fff}.header-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#333;margin-top:0;margin-bottom:4px;font-size:1.6rem}.search-section[_ngcontent-%COMP%]{margin-bottom:20px}.search-and-sort-container[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:flex-end;max-width:800px;margin:0 auto}.search-and-sort-container[_ngcontent-%COMP%]   .controls-row[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:end}.search-and-sort-container[_ngcontent-%COMP%]   .controls-row[_ngcontent-%COMP%]   .sort-container[_ngcontent-%COMP%]{flex-grow:1}@media (max-width: 768px){.search-and-sort-container[_ngcontent-%COMP%]{flex-direction:column;gap:15px;align-items:stretch}}.search-input-container[_ngcontent-%COMP%]{position:relative;flex:1}.search-input-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{border:2px solid #e1e5e9;border-radius:8px;font-size:1rem;transition:all .3s ease;box-shadow:0 2px 4px #0000000d;width:100%;box-sizing:border-box;background-color:#fff;background-image:var(--search-icon-url);background-position:10px 8px;background-repeat:no-repeat;padding:12px 20px 12px 40px;text-overflow:ellipsis}.search-input-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 3px #007bff1a}.search-input-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#6c757d}.search-input-container[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;right:16px;top:50%;transform:translateY(-50%);color:#6c757d;font-size:1.1rem;pointer-events:none}.sort-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:150px}.sort-container[_ngcontent-%COMP%]   .sort-label[_ngcontent-%COMP%]{font-size:.85rem;color:#6c757d;margin-bottom:4px;font-weight:500}.sort-container[_ngcontent-%COMP%]   .sort-select[_ngcontent-%COMP%]{padding:12px 16px;border:2px solid #e1e5e9;border-radius:8px;font-size:1rem;background:#fff;cursor:pointer;transition:all .3s ease;box-shadow:0 2px 4px #0000000d;color:#6c757d}.sort-container[_ngcontent-%COMP%]   .sort-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 3px #007bff1a}.sort-container[_ngcontent-%COMP%]   .sort-select[_ngcontent-%COMP%]:hover{border-color:#c6d0dc}.sort-container[_ngcontent-%COMP%]   .sort-select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#6c757d}.starred-filter-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:flex-end}.starred-filter-container[_ngcontent-%COMP%]   .sort-label[_ngcontent-%COMP%]{font-size:.85rem;color:#6c757d;margin-bottom:4px;font-weight:500;text-align:center}.starred-filter-container[_ngcontent-%COMP%]   app-star-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:8px 0;border-radius:8px;transition:background-color .2s ease}.starred-filter-container[_ngcontent-%COMP%]   app-star-button[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.arrays-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:15px}.array-card[_ngcontent-%COMP%]{background:#fff;border:2px solid #ddd;border-radius:6px;padding:15px;box-shadow:0 2px 4px #0000001a;transition:all .3s ease;cursor:pointer;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}.array-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #00000026;transform:translateY(-2px)}.array-card.selected[_ngcontent-%COMP%]{border:2px solid #007bff;box-shadow:0 0 0 3px #007bff33;transform:translateY(-2px);background:#f8f9fa}.array-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;border-bottom:1px solid #eee;padding-bottom:8px}.array-header[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.array-header[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#2c5aa0;font-size:1.1rem}.array-header[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .selected-badge[_ngcontent-%COMP%]{background:#007bff;color:#fff;padding:2px 6px;border-radius:10px;font-size:.65rem;font-weight:700;text-transform:uppercase;letter-spacing:.3px}.array-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;height:32px}.array-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:6px}.array-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .more-button-container[_ngcontent-%COMP%]{display:none;position:relative}.array-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .total-cards[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2;padding:3px 6px;border-radius:3px;font-size:.8rem;font-weight:600}.array-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .total-cards.all-done[_ngcontent-%COMP%]{background-color:#d4edda;color:#16a34a}.array-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .total-cards.none-done[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}@media (max-width: 768px){.array-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:none}.array-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .more-button-container[_ngcontent-%COMP%]{display:block}.array-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .mobile-action-buttons[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;z-index:10;background:#ffffffbf;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);border-radius:8px;box-shadow:0 4px 12px #00000026;padding:8px;margin-top:4px;display:flex;flex-direction:column;gap:8px;visibility:hidden;opacity:0;transform:translateY(-10px);pointer-events:none;transition:visibility 0s linear .2s,opacity .2s ease-in-out,transform .2s ease-in-out}.array-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .mobile-action-buttons.expanded[_ngcontent-%COMP%]{visibility:visible;opacity:1;transform:translateY(0);pointer-events:auto;transition:visibility 0s linear 0s,opacity .2s ease-in-out,transform .2s ease-in-out}}.array-details[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:.9rem;color:#666;margin-bottom:12px;line-height:1.3}.array-details[_ngcontent-%COMP%]   .labels-section[_ngcontent-%COMP%]{margin-bottom:12px}.array-details[_ngcontent-%COMP%]   .labels-section[_ngcontent-%COMP%]   .labels-label[_ngcontent-%COMP%]{font-size:.75rem;color:#888;text-transform:uppercase;letter-spacing:.3px;font-weight:500;display:block;margin-bottom:4px}.array-details[_ngcontent-%COMP%]   .labels-section[_ngcontent-%COMP%]   .labels-list[_ngcontent-%COMP%]{display:flex;gap:6px;flex-wrap:wrap}.array-details[_ngcontent-%COMP%]   .labels-section[_ngcontent-%COMP%]   .labels-list[_ngcontent-%COMP%]   .labels[_ngcontent-%COMP%]{font-size:.85rem;color:#555;font-style:italic;background:#f8f9fa;padding:6px 10px;border-radius:4px;border-left-width:3px;border-left-style:solid;margin:0;line-height:1.4;display:inline-block}.statistics[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.statistics[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{display:flex;flex-direction:column}.statistics[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.75rem;color:#888;text-transform:uppercase;letter-spacing:.3px}.statistics[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;color:#333;margin-top:1px;font-size:.9rem}.statistics[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .distribution-items[_ngcontent-%COMP%]{margin-top:4px;display:flex;flex-wrap:wrap;gap:6px}.statistics[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]{background:#f5f5f5;padding:2px 6px;border-radius:3px;font-size:.8rem;color:#555;border:1px solid #ddd}.statistics[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .distribution-item.distribution-green[_ngcontent-%COMP%]{background:#d4edda;color:#155724;border-color:#c3e6cb}.statistics[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .distribution-item.distribution-yellow[_ngcontent-%COMP%]{background:#fff3cd;color:#856404;border-color:#ffeaa7}.statistics[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .distribution-item.distribution-red[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;border-color:#f5c6cb}@media (max-width: 768px){.arrays-list[_ngcontent-%COMP%]{grid-template-columns:1fr}.array-header[_ngcontent-%COMP%]{align-items:flex-start;gap:8px}.array-header[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]{flex-wrap:wrap}.meta-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.meta-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{max-width:100%;text-align:left}}.header-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.header-section[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;max-width:1200px;margin:0 auto}.header-section[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#666;font-size:1rem;margin:0}.add-array-form[_ngcontent-%COMP%]{background:#fff;padding:1.5rem;border-radius:.6rem;box-shadow:0 4px 6px -1px #0000001a;max-width:500px;margin:0 auto 1.5rem}.add-array-form[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;color:#2c3e50;font-size:1.2rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.3rem;font-weight:600;color:#495057;font-size:.9rem}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.6rem;border:2px solid #dee2e6;border-radius:.4rem;font-size:.9rem;transition:border-color .2s ease}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff}.form-group[_ngcontent-%COMP%]   textarea.ng-invalid.ng-touched[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#dc3545}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical;font-family:inherit}.form-group[_ngcontent-%COMP%]   .label-input-container[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:8px;align-items:center}.form-group[_ngcontent-%COMP%]   .label-input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1}.form-group[_ngcontent-%COMP%]   .label-input-container[_ngcontent-%COMP%]   .btn-remove-label[_ngcontent-%COMP%]{background:#dc3545;color:#fff;border:none;border-radius:4px;width:32px;height:32px;font-size:1.2rem;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;flex-shrink:0}.form-group[_ngcontent-%COMP%]   .label-input-container[_ngcontent-%COMP%]   .btn-remove-label[_ngcontent-%COMP%]:hover{background:#c82333;transform:scale(1.05)}.form-group[_ngcontent-%COMP%]   .label-input-container[_ngcontent-%COMP%]   .btn-remove-label[_ngcontent-%COMP%]:active{transform:scale(.95)}.form-group[_ngcontent-%COMP%]   .btn-add-label[_ngcontent-%COMP%]{background:#28a745;color:#fff;border:none;border-radius:4px;padding:8px 12px;font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s ease;margin-top:4px}.form-group[_ngcontent-%COMP%]   .btn-add-label[_ngcontent-%COMP%]:hover:not(:disabled){background:#218838;transform:translateY(-1px)}.form-group[_ngcontent-%COMP%]   .btn-add-label[_ngcontent-%COMP%]:disabled{background:#6c757d;cursor:not-allowed;opacity:.6}.form-group[_ngcontent-%COMP%]   .btn-add-label[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.form-actions[_ngcontent-%COMP%]{display:flex;gap:.8rem}@media (max-width: 600px){.form-actions[_ngcontent-%COMP%]{flex-direction:column}}.btn[_ngcontent-%COMP%]{padding:.6rem 1.2rem;border:none;border-radius:.4rem;font-weight:600;cursor:pointer;transition:all .2s ease;text-decoration:none;display:inline-flex;align-items:center;justify-content:center;font-size:.85rem}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px)}.btn-primary[_ngcontent-%COMP%]{background:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#0056b3}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#5a6268}.header-buttons[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:0;max-width:500px;width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(-20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.modal-header[_ngcontent-%COMP%]{padding:24px 24px 12px;border-bottom:1px solid #e5e7eb}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:600;color:#111827}.modal-body[_ngcontent-%COMP%]{padding:16px 24px;color:#374151;line-height:1.6}.modal-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 12px}.modal-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.modal-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#dc3545;font-weight:600}.modal-actions[_ngcontent-%COMP%]{padding:16px 24px 24px;display:flex;gap:12px;justify-content:flex-end;border-top:1px solid #e5e7eb}.modal-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:6px;font-weight:600;font-size:.875rem;cursor:pointer;transition:all .2s ease;min-width:100px}.modal-actions[_ngcontent-%COMP%]   .btn.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.modal-actions[_ngcontent-%COMP%]   .btn.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c82333;transform:translateY(-1px);box-shadow:0 4px 8px #dc35454d}.modal-actions[_ngcontent-%COMP%]   .btn.btn-danger[_ngcontent-%COMP%]:active{transform:translateY(0)}.modal-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.modal-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#5a6268;transform:translateY(-1px);box-shadow:0 4px 8px #6c757d4d}.modal-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:active{transform:translateY(0)}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}@media (max-width: 768px){.modal-content[_ngcontent-%COMP%]{width:95%;margin:20px}.modal-actions[_ngcontent-%COMP%]{flex-direction:column-reverse}.modal-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}.header-section[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}.header-buttons[_ngcontent-%COMP%]{justify-content:center}}@media (max-width: 768px){.header-section[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex-direction:column;gap:20px;align-items:center}}"]})};var De=class i{defaultLang="nl-BE";voices=O([]);defaultVoice=L(()=>this.voices().find(t=>t.lang==="nl-BE"));speechSynthesis=window.speechSynthesis;constructor(){this.speechSynthesis.onvoiceschanged=()=>{this.voices.set(speechSynthesis.getVoices())}}speak(t,e=this.defaultLang,n=1){let r=new SpeechSynthesisUtterance(t);r.lang=e,r.rate=n;let o=e===this.defaultLang?this.defaultVoice():this.voices().find(a=>a.lang===e);console.log(o),o&&(r.voice=o),this.speechSynthesis.speak(r)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=it({token:i,factory:i.\u0275fac,providedIn:"root"})};var mr=(i,t)=>t.timestamp;function _r(i,t){i&1&&(A(0,"div",5)(1,"p"),u(2),g(3,"translate"),B()()),i&2&&(s(2),m(f(3,1,"flashcards.rating-history.no-history")))}function Cr(i,t){if(i&1&&(A(0,"div",9)(1,"div",10)(2,"span",11),u(3),B(),A(4,"span",12),u(5),B()(),A(6,"div",13)(7,"div",14)(8,"span",15),u(9),g(10,"translate"),B(),A(11,"span",16),u(12),B()(),A(13,"div",14)(14,"span",15),u(15),g(16,"translate"),B(),A(17,"span",16),u(18),B()(),A(19,"div",14)(20,"span",15),u(21),g(22,"translate"),B(),A(23,"span",16),u(24),B()()()()),i&2){let e=t.$implicit,n=p(2);s(2),Jt(n.getRatingClass(e.rating)),s(),E(" ",n.getRatingLabel(e.rating)," "),s(),Zt("title",n.formatDate(e.timestamp)),s(),E(" ",n.formatRelativeTime(e.timestamp)," "),s(4),E("",f(10,11,"flashcards.rating-history.state"),":"),s(3),m(n.getStateLabel(e.state)),s(3),E("",f(16,13,"flashcards.rating-history.stability"),":"),s(3),m(e.stability.toFixed(2)),s(3),E("",f(22,15,"flashcards.rating-history.difficulty"),":"),s(3),m(e.difficulty.toFixed(2))}}function vr(i,t){if(i&1&&(A(0,"div",6),Q(1,Cr,25,17,"div",9,mr),B()),i&2){let e=p();s(),X(e.sortedHistory())}}var Ee=class i{ratingHistory=q.required();close=at();sortedHistory=L(()=>[...this.ratingHistory()].sort((t,e)=>e.timestamp.getTime()-t.timestamp.getTime()));getRatingLabel(t){switch(t){case h.Again:return"Again";case h.Hard:return"Hard";case h.Good:return"Good";case h.Easy:return"Easy";default:return"Unknown"}}getRatingClass(t){switch(t){case h.Again:return"rating-again";case h.Hard:return"rating-hard";case h.Good:return"rating-good";case h.Easy:return"rating-easy";default:return""}}getStateLabel(t){switch(t){case y.New:return"New";case y.Learning:return"Learning";case y.Review:return"Review";case y.Relearning:return"Relearning";default:return"Unknown"}}formatDate(t){return new Intl.DateTimeFormat("default",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}formatRelativeTime(t){let n=new Date().getTime()-t.getTime(),r=Math.floor(n/(1e3*60)),o=Math.floor(n/(1e3*60*60)),a=Math.floor(n/(1e3*60*60*24));return r<1?"Just now":r<60?`${r}m ago`:o<24?`${o}h ago`:a<30?`${a}d ago`:`${Math.floor(a/30)}mo ago`}onClose(){this.close.emit()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=$({type:i,selectors:[["app-rating-history"]],inputs:{ratingHistory:[1,"ratingHistory"]},outputs:{close:"close"},decls:15,vars:7,consts:[[1,"rating-history-overlay",3,"click"],[1,"rating-history-modal",3,"click"],[1,"modal-header"],["type","button","aria-label","Close",1,"close-button",3,"click"],[1,"modal-body"],[1,"empty-state"],[1,"history-list"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],[1,"history-entry"],[1,"entry-header"],[1,"rating-badge"],[1,"entry-time",3,"title"],[1,"entry-details"],[1,"detail-item"],[1,"detail-label"],[1,"detail-value"]],template:function(e,n){e&1&&(A(0,"div",0),K("click",function(){return n.onClose()}),A(1,"div",1),K("click",function(o){return o.stopPropagation()}),A(2,"div",2)(3,"h3"),u(4),g(5,"translate"),B(),A(6,"button",3),K("click",function(){return n.onClose()}),u(7," \xD7 "),B()(),A(8,"div",4),N(9,_r,4,3,"div",5)(10,vr,3,0,"div",6),B(),A(11,"div",7)(12,"button",8),K("click",function(){return n.onClose()}),u(13),g(14,"translate"),B()()()()),e&2&&(s(4),m(f(5,3,"flashcards.rating-history.title")),s(5),T(n.sortedHistory().length===0?9:10),s(4),E(" ",f(14,5,"common.close")," "))},dependencies:[st,lt],styles:[".rating-history-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.rating-history-modal[_ngcontent-%COMP%]{background:#fff;border-radius:8px;max-width:600px;width:100%;max-height:80vh;display:flex;flex-direction:column;box-shadow:0 4px 6px #0000001a}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem;border-bottom:1px solid #e5e7eb}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:600}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{background:none;border:none;font-size:2rem;line-height:1;cursor:pointer;color:#6b7280;padding:0;width:2rem;height:2rem;display:flex;align-items:center;justify-content:center;border-radius:4px;transition:background-color .2s,color .2s}.modal-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;color:#111827}.modal-body[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:1.5rem}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#6b7280}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.history-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.history-entry[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:6px;padding:1rem;background-color:#f9fafb}.history-entry[_ngcontent-%COMP%]   .entry-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.75rem}.history-entry[_ngcontent-%COMP%]   .rating-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:4px;font-weight:600;font-size:.875rem;color:#fff}.history-entry[_ngcontent-%COMP%]   .rating-badge.rating-again[_ngcontent-%COMP%]{background-color:#dc2626}.history-entry[_ngcontent-%COMP%]   .rating-badge.rating-hard[_ngcontent-%COMP%]{background-color:#ea580c}.history-entry[_ngcontent-%COMP%]   .rating-badge.rating-good[_ngcontent-%COMP%]{background-color:#16a34a}.history-entry[_ngcontent-%COMP%]   .rating-badge.rating-easy[_ngcontent-%COMP%]{background-color:#2563eb}.history-entry[_ngcontent-%COMP%]   .entry-time[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280}.history-entry[_ngcontent-%COMP%]   .entry-details[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:.5rem}.history-entry[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;gap:.5rem;font-size:.875rem}.history-entry[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{color:#6b7280;font-weight:500}.history-entry[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{color:#111827}.modal-footer[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:1px solid #e5e7eb;display:flex;justify-content:flex-end}.modal-footer[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.5rem 1.5rem;border-radius:6px;font-weight:500;cursor:pointer;border:none;transition:background-color .2s}.modal-footer[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]{background-color:#2563eb;color:#fff}.modal-footer[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:hover{background-color:#1d4ed8}"]})};var yr=()=>[],br=(i,t)=>t.id;function xr(i,t){if(i&1){let e=R();l(0,"div",5)(1,"app-star-button",6),C("toggle",function(){b(e);let r=p(2);return x(r.toggleStarred(r.currentCollection()))}),c(),l(2,"span",7),u(3),c()()}if(i&2){let e=p(2);s(),w("starred",e.currentCollection().starred),s(2),m(e.currentCollection().name)}}function Mr(i,t){if(i&1&&(l(0,"div",0)(1,"span"),u(2),g(3,"translate"),c(),l(4,"span"),u(5),g(6,"translate"),c(),N(7,xr,4,2,"div",5),c()),i&2){let e=p();s(2),mt("",f(3,5,"flashcards.due-cards")," ",e.dueCards().length),s(3),mt("",f(6,7,"flashcards.total-cards")," ",e.allCards().length),s(2),T(e.currentCollection()?7:-1)}}function wr(i,t){i&1&&(l(0,"div",1)(1,"p"),u(2),g(3,"translate"),c()()),i&2&&(s(2),m(f(3,1,"flashcards.loading-cards")))}function Sr(i,t){i&1&&(l(0,"div",2)(1,"h2"),u(2),g(3,"translate"),c(),l(4,"p"),u(5),g(6,"translate"),c()()),i&2&&(s(2),m(f(3,2,"flashcards.no-cards.title")),s(3),m(f(6,4,"flashcards.no-cards.message")))}function Or(i,t){if(i&1){let e=R();l(0,"button",14),C("click",function(){b(e);let r=p(2);return x(r.revealCard())}),u(1),g(2,"translate"),c()}i&2&&(s(),E("",f(2,1,"flashcards.card.show-answer")," "))}function Pr(i,t){if(i&1){let e=R();l(0,"button",20),C("click",function(){b(e);let r=p(3);return x(r.rateCard(1))}),l(1,"span",21),u(2),g(3,"translate"),c(),l(4,"span",22),u(5),c()(),l(6,"button",23),C("click",function(){b(e);let r=p(3);return x(r.rateCard(2))}),l(7,"span",21),u(8),g(9,"translate"),c(),l(10,"span",22),u(11),c()(),l(12,"button",24),C("click",function(){b(e);let r=p(3);return x(r.rateCard(3))}),l(13,"span",21),u(14),g(15,"translate"),c(),l(16,"span",22),u(17),c()(),l(18,"button",25),C("click",function(){b(e);let r=p(3);return x(r.rateCard(4))}),l(19,"span",21),u(20),g(21,"translate"),c(),l(22,"span",22),u(23),c()()}if(i&2){let e=t,n=p(3);s(2),m(f(3,8,"flashcards.card.rating.again")),s(3),m(n.formatTimeUntil(e.again)),s(3),m(f(9,10,"flashcards.card.rating.hard")),s(3),m(n.formatTimeUntil(e.hard)),s(3),m(f(15,12,"flashcards.card.rating.good")),s(3),m(n.formatTimeUntil(e.good)),s(3),m(f(21,14,"flashcards.card.rating.easy")),s(3),m(n.formatTimeUntil(e.easy))}}function Vr(i,t){if(i&1){let e=R();l(0,"div",13)(1,"p"),u(2),g(3,"translate"),c(),l(4,"div",15)(5,"h3"),u(6),c(),l(7,"button",16),C("click",function(){b(e);let r=p(2);return x(r.speakText(r.currentCard().back))}),u(8," \u{1F50A} "),c(),l(9,"button",17),C("click",function(){b(e);let r=p(2);return x(r.speakTextSlow(r.currentCard().back))}),u(10," \u{1F40C} "),c()(),l(11,"div",18)(12,"small"),u(13),c()(),l(14,"div",19),N(15,Pr,24,16),c()()}if(i&2){let e,n=p(2);s(2),m(f(3,4,"flashcards.card.answer")),s(4),m(n.currentCard().back),s(7),m(n.getCardStats(n.currentCard())),s(2),T((e=n.getSchedulingPreview())?15:-1,e)}}function Dr(i,t){if(i&1){let e=R();l(0,"div",3)(1,"div",8)(2,"div",9)(3,"h3"),u(4),c(),l(5,"div",10)(6,"app-button",11),g(7,"translate"),C("click",function(){b(e);let r=p();return x(r.toggleRatingHistory())}),c()()(),N(8,Or,3,3,"button",12)(9,Vr,16,6,"div",13),c()()}if(i&2){let e=p();s(),H("revealed",e.currentCard().isRevealed),s(3),m(e.currentCard().front),s(2),w("size",e.ButtonSize.SMALL)("icon",e.assetUrlService.getHistoryIconUrl())("title",f(7,7,"flashcards.rating-history.show")),s(2),T(e.currentCard().isRevealed?9:8)}}function Er(i,t){if(i&1&&(l(0,"option",36),u(1),c()),i&2){let e=t.$implicit;w("value",e.id),s(),E(" ",e.name," ")}}function kr(i,t){if(i&1){let e=R();l(0,"div",26)(1,"h3"),u(2),g(3,"translate"),c(),l(4,"form",28),C("ngSubmit",function(){b(e);let r=p(2);return x(r.addCard())}),l(5,"div",29)(6,"label",30),u(7),g(8,"translate"),c(),l(9,"textarea",31),g(10,"translate"),u(11,"      "),c()(),l(12,"div",29)(13,"label",32),u(14),g(15,"translate"),c(),l(16,"textarea",33),g(17,"translate"),u(18,"      "),c()(),l(19,"div",29)(20,"label",34),u(21),g(22,"translate"),c(),l(23,"select",35),Q(24,Er,2,2,"option",36,br),c()(),l(26,"div",37)(27,"button",38),u(28),g(29,"translate"),c(),l(30,"button",39),C("click",function(){b(e);let r=p(2);return x(r.addCardAndNew())}),u(31),g(32,"translate"),c(),l(33,"button",40),C("click",function(){b(e);let r=p(2);return x(r.cancelAddCard())}),u(34),g(35,"translate"),c()()()()}if(i&2){let e=p(2);s(2),m(f(3,12,"flashcards.card.add-card")),s(2),w("formGroup",e.cardForm),s(3),m(f(8,14,"flashcards.card.front")),s(2),w("placeholder",f(10,16,"flashcards.card.front-input-placeholder")),s(5),m(f(15,18,"flashcards.card.back")),s(2),w("placeholder",f(17,20,"flashcards.card.back-input-placeholder")),s(5),m(f(22,22,"flashcards.card.select-collection")),s(3),X(e.selectedCollectionMetadata()),s(3),w("disabled",e.cardForm.invalid),s(),E("",f(29,24,"flashcards.card.confirm-add-card")," "),s(2),w("disabled",e.cardForm.invalid),s(),E("",f(32,26,"flashcards.card.save-and-add-new")," "),s(3),E("",f(35,28,"common.cancel")," ")}}function Ar(i,t){if(i&1){let e=R();l(0,"div",27)(1,"button",41),C("click",function(){b(e);let r=p(2);return x(r.showAddCardForm())}),u(2),g(3,"translate"),c(),l(4,"button",42),C("click",function(){b(e);let r=p(2);return x(r.resetAllCards())}),u(5),g(6,"translate"),c()()}i&2&&(s(2),E("",f(3,2,"flashcards.card.confirm-add-card")," "),s(3),E(" ",f(6,4,"flashcards.card.reset-cards")," "))}function Ir(i,t){if(i&1&&N(0,kr,36,30,"div",26)(1,Ar,7,6,"div",27),i&2){let e=p();T(e.showAddForm()?0:1)}}function Fr(i,t){if(i&1){let e=R();l(0,"app-rating-history",43),C("close",function(){b(e);let r=p();return x(r.closeRatingHistory())}),c()}if(i&2){let e=p();w("ratingHistory",e.currentCard().ratingHistory||Qt(1,yr))}}var ke=class i{fb=k(ye);fsrs=new Se({});collectionsService=k(Et);speakService=k(De);assetUrlService=k(Ot);isLoading=O(!0);allCards=O([]);currentCardIndex=O(0);showAddForm=O(!1);showRatingHistory=O(!1);translate=k(vt);platformId=k(gt);isBrowser=_t(this.platformId);http=k(Xt);selectedFlashcards=q.required();selectedCollectionMetadata=L(()=>this.collectionsService.getCollections(this.selectedFlashcards()));cardForm=this.fb.nonNullable.group({front:["",[G.required]],back:["",[G.required]],collection:["",[G.required]]});dueCards=L(()=>{if(this.isLoading())return[];let t=new Date;return this.allCards().filter(e=>e.fsrsCard.state===y.New||e.fsrsCard.due<=t)});currentCard=L(()=>{let t=this.dueCards(),e=this.currentCardIndex();return t[e]||null});currentCollection=L(()=>{let t=this.currentCard();return t?this.collectionsService.getCollection(t.collection):null});getSchedulingPreview=L(()=>{let t=this.currentCard();if(!t)return null;let e=this.fsrs.repeat(t.fsrsCard,new Date);return{again:e[h.Again].card.due,hard:e[h.Hard].card.due,good:e[h.Good].card.due,easy:e[h.Easy].card.due}});ngOnInit(){this.loadCards();let t=this.selectedCollectionMetadata();if(t.length===1){let e=t[0];this.cardForm.get("collection")?.setValue(e.id)}}revealCard(){let t=this.currentCard();if(t){let e=this.allCards().map(n=>n.id===t.id?P(S({},n),{isRevealed:!0}):n);this.allCards.set(e)}}rateCard(t){let e=this.currentCard();if(!e)return;let n=t===1?h.Again:t===2?h.Hard:t===3?h.Good:h.Easy,o=this.fsrs.repeat(e.fsrsCard,new Date)[n].card,a={timestamp:new Date,rating:n,stability:o.stability,difficulty:o.difficulty,state:o.state},d=this.allCards().map(_=>_.id===e.id?P(S({},_),{fsrsCard:o,isRevealed:!1,ratingHistory:[..._.ratingHistory||[],a]}):_);this.allCards.set(d),this.saveCards(e.collection);let v=this.dueCards();v.length===0?this.currentCardIndex.set(0):this.currentCardIndex()>=v.length&&this.currentCardIndex.set(0)}addCard(){if(this.cardForm.valid){let t=this.cardForm.getRawValue(),e={id:crypto.randomUUID(),front:t.front,back:t.back,fsrsCard:pt(),isRevealed:!1,collection:t.collection,ratingHistory:[]};this.allCards.update(n=>[...n,e]),this.saveCards(t.collection),this.cancelAddCard()}}addCardAndNew(){if(this.cardForm.valid){let t=this.cardForm.getRawValue(),e={id:crypto.randomUUID(),front:t.front,back:t.back,fsrsCard:pt(),isRevealed:!1,collection:t.collection,ratingHistory:[]};this.allCards.update(n=>[...n,e]),this.saveCards(t.collection),this.cardForm.patchValue({front:"",back:""}),this.cardForm.get("front")?.markAsUntouched(),this.cardForm.get("front")?.markAsPristine(),this.cardForm.get("back")?.markAsUntouched(),this.cardForm.get("back")?.markAsPristine()}}cancelAddCard(){this.showAddForm.set(!1),this.cardForm.reset()}showAddCardForm(){this.showAddForm.set(!0);let t=this.selectedCollectionMetadata();t.length===1&&this.cardForm.patchValue({collection:t[0].id})}resetAllCards(){if(confirm(this.translate.instant("flashcards.reset-cards-modal.message"))){let t=this.allCards().map(e=>P(S({},e),{fsrsCard:pt(),isRevealed:!1,ratingHistory:[]}));this.allCards.set(t),this.currentCardIndex.set(0),this.selectedCollectionMetadata().forEach(e=>{this.saveCards(e.id)})}}formatTimeUntil(t){let e=new Date,n=t.getTime()-e.getTime(),r=Math.floor(n/(1e3*60)),o=Math.floor(n/(1e3*60*60)),a=Math.floor(n/(1e3*60*60*24));return r<60?`${Math.max(1,r)}m`:o<24?`${o}h`:a<30?`${a}d`:`${Math.floor(a/30)}mo`}getCardStats(t){let e=t.fsrsCard;if(e.state===y.New)return this.translate.instant("flashcards.new-card");let n=e.reps,r=e.lapses,o=Math.round(e.difficulty*10)/10;return`${n} ${this.translate.instant("flashcards.reviews")}, ${r} ${this.translate.instant("flashcards.lapses")}, ${this.translate.instant("flashcards.difficulty")}: ${o}`}speakText(t){this.speakService.speak(t)}speakTextSlow(t){this.speakService.speak(t,"nl-BE",.55)}saveCards(t){if(!this.isBrowser)return;let e=this.allCards().filter(r=>r.collection===t),n=e.map(r=>({collection:r.collection,id:r.id,front:r.front,back:r.back,fsrsCard:{due:r.fsrsCard.due.toISOString(),stability:r.fsrsCard.stability,difficulty:r.fsrsCard.difficulty,elapsed_days:r.fsrsCard.elapsed_days,scheduled_days:r.fsrsCard.scheduled_days,reps:r.fsrsCard.reps,lapses:r.fsrsCard.lapses,state:r.fsrsCard.state,last_review:r.fsrsCard.last_review?.toISOString()},ratingHistory:r.ratingHistory?.map(o=>({timestamp:o.timestamp.toISOString(),rating:o.rating,stability:o.stability,difficulty:o.difficulty,state:o.state}))}));localStorage.setItem(t,JSON.stringify(n)),this.collectionsService.updateCollectionStats(t,e)}loadCards(){this.isBrowser&&(this.selectedCollectionMetadata().forEach(t=>{let e=localStorage.getItem(t.id);if(e)try{let r=JSON.parse(e).map(o=>({collection:t.id,id:o.id,front:o.front,back:o.back,isRevealed:!1,fsrsCard:P(S({},o.fsrsCard),{due:new Date(o.fsrsCard.due),last_review:o.fsrsCard.last_review?new Date(o.fsrsCard.last_review):void 0}),ratingHistory:o.ratingHistory?.map(a=>({timestamp:new Date(a.timestamp),rating:a.rating,stability:a.stability,difficulty:a.difficulty,state:a.state}))||[]}));this.allCards.update(o=>[...o,...r])}catch(n){console.error("Error loading cards:",n),this.initializeSampleCards(t)}else this.initializeSampleCards(t)}),setTimeout(()=>{this.isLoading.set(!1)},200))}initializeSampleCards(t){t.path&&this.http.get(Ct.firstPath+t.path).subscribe({next:e=>{let n=e.map(r=>({collection:t.id,id:crypto.randomUUID(),front:r.front,back:r.back,isRevealed:!1,fsrsCard:P(S({},r.fsrsCard),{due:new Date(r.fsrsCard.due),last_review:r.fsrsCard.last_review?new Date(r.fsrsCard.last_review):void 0}),ratingHistory:[]}));this.allCards.update(r=>[...r,...n]),this.saveCards(t.id)},error:e=>{console.error("Error loading flashcards:",e)}})}toggleStarred(t){this.collectionsService.updateCollection(t.id,{starred:!t.starred})}toggleRatingHistory(){this.showRatingHistory.set(!0)}closeRatingHistory(){this.showRatingHistory.set(!1)}ButtonSize=Vt;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=$({type:i,selectors:[["app-selection"]],inputs:{selectedFlashcards:[1,"selectedFlashcards"]},decls:6,vars:4,consts:[[1,"stats"],[1,"loading"],[1,"no-cards"],[1,"study-area"],[3,"ratingHistory"],[1,"current-collection-container"],[3,"toggle","starred"],[1,"current-array"],[1,"flashcard"],[1,"title-bar"],[1,"history-button"],[3,"click","size","icon","title"],["type","button",1,"btn","btn-secondary","reveal-button"],[1,"card-back"],["type","button",1,"btn","btn-secondary","reveal-button",3,"click"],[1,"card-text-with-speaker"],["type","button","aria-label","Speak",1,"btn-speaker",3,"click"],["type","button","aria-label","Speak slowly",1,"btn-speaker","btn-speaker-slow",3,"click"],[1,"card-stats"],[1,"rating-buttons"],["type","button",1,"btn","btn-rating","btn-again",3,"click"],[1,"rating-label"],[1,"rating-time"],["type","button",1,"btn","btn-rating","btn-hard",3,"click"],["type","button",1,"btn","btn-rating","btn-good",3,"click"],["type","button",1,"btn","btn-rating","btn-easy",3,"click"],[1,"add-card-form"],[1,"controls"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","front"],["id","front","formControlName","front","rows","3",3,"placeholder"],["for","back"],["id","back","formControlName","back","rows","3",3,"placeholder"],["for","collection"],["id","collection","formControlName","collection",1,"form-control"],[3,"value"],[1,"form-actions"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-outline",3,"click"],["type","button",1,"btn","btn-outline","btn-danger",3,"click"],[3,"close","ratingHistory"]],template:function(e,n){e&1&&(N(0,Mr,8,9,"div",0),N(1,wr,4,3,"div",1)(2,Sr,7,6,"div",2)(3,Dr,10,9,"div",3),N(4,Ir,2,1),N(5,Fr,1,2,"app-rating-history",4)),e&2&&(T(n.isLoading()?-1:0),s(),T(n.isLoading()?1:n.currentCard()?3:2),s(3),T(n.isLoading()?-1:4),s(),T(n.showRatingHistory()&&n.currentCard()?5:-1))},dependencies:[st,St,fe,Ce,ve,Mt,_e,ue,he,wt,jt,kt,Pt,Ee,lt],styles:[".stats[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1.5rem;align-items:center}.stats[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:.4rem .8rem;background:#f8f9fa;border-radius:.4rem;font-weight:500;font-size:.9rem}.stats[_ngcontent-%COMP%]   span.current-array[_ngcontent-%COMP%]{background:#007bff;color:#fff;font-weight:600}.stats[_ngcontent-%COMP%]   .current-collection-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.4rem;padding:.4rem .8rem;background:#007bff;border-radius:.4rem}.stats[_ngcontent-%COMP%]   .current-collection-container[_ngcontent-%COMP%]   .current-array[_ngcontent-%COMP%]{background:transparent;color:#fff;font-weight:600;padding:0}.stats[_ngcontent-%COMP%]   .current-collection-container[_ngcontent-%COMP%]   app-star-button[_ngcontent-%COMP%]     .star-icon{color:#fff9}.stats[_ngcontent-%COMP%]   .current-collection-container[_ngcontent-%COMP%]   app-star-button.starred[_ngcontent-%COMP%]     .star-icon{color:gold}.no-cards[_ngcontent-%COMP%]{text-align:center;padding:2rem}.no-cards[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#6c757d;margin-bottom:1rem;font-size:1.4rem}.study-area[_ngcontent-%COMP%]{margin:1.5rem 0}.study-area[_ngcontent-%COMP%]   .card-counter[_ngcontent-%COMP%]{text-align:center;margin-bottom:.8rem;font-weight:600;color:#6c757d;font-size:.9rem}.flashcard[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;background:#fff;border-radius:.6rem;box-shadow:0 4px 6px -1px #0000001a;padding:1.5rem;min-height:270px;text-align:center;transition:all .3s ease}.flashcard[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{display:flex;justify-content:center}.flashcard[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .history-button[_ngcontent-%COMP%]{margin:1rem}.flashcard.revealed[_ngcontent-%COMP%]{background:#f8f9fa}.flashcard[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]{width:100%}.flashcard[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;color:#2c3e50;font-size:1.2rem}.flashcard[_ngcontent-%COMP%]   .card-back[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5;margin-bottom:1rem}.flashcard[_ngcontent-%COMP%]   .card-stats[_ngcontent-%COMP%]{margin:.8rem 0;text-align:center}.flashcard[_ngcontent-%COMP%]   .card-stats[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#6c757d;font-size:.85rem}.flashcard[_ngcontent-%COMP%]   .card-text-with-speaker[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;margin-bottom:1rem}.flashcard[_ngcontent-%COMP%]   .card-text-with-speaker[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0!important}.flashcard[_ngcontent-%COMP%]   .card-text-with-speaker[_ngcontent-%COMP%]   .btn-speaker[_ngcontent-%COMP%]{background:#f0f0f0;border:1px solid #ddd;cursor:pointer;font-size:1.5rem;padding:.4rem;border-radius:.3rem;transition:all .2s ease;opacity:1;flex-shrink:0;line-height:1;display:inline-flex;align-items:center;justify-content:center;min-width:2rem;min-height:2rem}.flashcard[_ngcontent-%COMP%]   .card-text-with-speaker[_ngcontent-%COMP%]   .btn-speaker[_ngcontent-%COMP%]:hover{background:#007bff33;border-color:#007bff;transform:scale(1.1)}.flashcard[_ngcontent-%COMP%]   .card-text-with-speaker[_ngcontent-%COMP%]   .btn-speaker[_ngcontent-%COMP%]:active{transform:scale(.95)}.rating-buttons[_ngcontent-%COMP%]{display:flex;gap:.8rem;margin-top:1.5rem;justify-content:center}@media (max-width: 600px){.rating-buttons[_ngcontent-%COMP%]{justify-content:space-between;align-items:center}}.btn[_ngcontent-%COMP%]{padding:.6rem 1rem;border:none;border-radius:.4rem;font-weight:600;cursor:pointer;transition:all .2s ease;text-decoration:none;display:inline-flex;align-items:center;justify-content:center;font-size:.85rem}.btn.reveal-button[_ngcontent-%COMP%]{margin:0 10rem;padding:.9rem 1rem}@media (max-width: 600px){.btn.reveal-button[_ngcontent-%COMP%]{margin:0}}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px)}.btn-primary[_ngcontent-%COMP%]{background:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#0056b3}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#545b62}.btn-outline[_ngcontent-%COMP%]{background:transparent;border:2px solid #007bff;color:#007bff}.btn-outline[_ngcontent-%COMP%]:hover:not(:disabled){background:#007bff;color:#fff}.btn-outline.btn-danger[_ngcontent-%COMP%]{border-color:#dc3545;color:#dc3545}.btn-outline.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#dc3545;color:#fff}.btn-rating[_ngcontent-%COMP%]{min-width:60px;display:flex;flex-direction:column;align-items:center;gap:.25rem}.btn-rating[_ngcontent-%COMP%]   .rating-label[_ngcontent-%COMP%]{font-weight:600}.btn-rating[_ngcontent-%COMP%]   .rating-time[_ngcontent-%COMP%]{font-size:.8rem;opacity:.8}.btn-rating.btn-again[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.btn-rating.btn-again[_ngcontent-%COMP%]:hover{background:#c82333}.btn-rating.btn-hard[_ngcontent-%COMP%]{background:#fd7e14;color:#fff}.btn-rating.btn-hard[_ngcontent-%COMP%]:hover{background:#e8690b}.btn-rating.btn-good[_ngcontent-%COMP%]{background:#28a745;color:#fff}.btn-rating.btn-good[_ngcontent-%COMP%]:hover{background:#1e7e34}.btn-rating.btn-easy[_ngcontent-%COMP%]{background:#17a2b8;color:#fff}.btn-rating.btn-easy[_ngcontent-%COMP%]:hover{background:#138496}.add-card-form[_ngcontent-%COMP%]{background:#fff;padding:1.5rem;border-radius:.6rem;box-shadow:0 4px 6px -1px #0000001a;margin-bottom:1.5rem}.add-card-form[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;color:#2c3e50;font-size:1.2rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;color:#495057}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 1.5rem);padding:.75rem;border:2px solid #dee2e6;border-radius:.5rem;font-size:1rem;transition:border-color .2s ease}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff}.form-group[_ngcontent-%COMP%]   textarea.ng-invalid.ng-touched[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#dc3545}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical;font-family:inherit}.form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:2px solid #dee2e6;border-radius:.5rem;font-size:1rem;background:#fff;transition:border-color .2s ease}.form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff}.form-group[_ngcontent-%COMP%]   select.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#dc3545}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem}@media (max-width: 600px){.form-actions[_ngcontent-%COMP%]{flex-direction:column}}.controls[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;margin-top:2rem}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;max-width:200px}@media (max-width: 600px){.controls[_ngcontent-%COMP%]{flex-direction:column;align-items:center}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;max-width:none}}.loading[_ngcontent-%COMP%]{text-align:center;padding:3rem}.loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d;font-size:1.1rem}"]})};function Nr(i,t){i&1&&(l(0,"div",1)(1,"div",7),qt(),l(2,"svg",8)(3,"circle",9),ut(4,"animateTransform",10),c()(),an(),l(5,"div",11),u(6,"Loading..."),c()()())}function Tr(i,t){if(i&1){let e=R();l(0,"app-collections",12),C("startStudyingCollection",function(r){b(e);let o=p();return x(o.onArraySelected(r))}),c()}}function Br(i,t){if(i&1&&ut(0,"app-selection",6),i&2){let e=p();w("selectedFlashcards",e.selectedFlashcards())}}var Xn=class i{currentView=O("collections");selectedFlashcards=O([]);platformId=k(gt);isBrowser=_t(this.platformId);onArraySelected(t){this.selectedFlashcards.set(t),this.currentView.set("flashcards")}toggleToCollections(){this.currentView.set("collections")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=$({type:i,selectors:[["app-flashcards"]],decls:14,vars:13,consts:[[1,"spaced-repetition-container"],[1,"loading-overlay"],[1,"header"],[1,"header-top"],[1,"view-navigation"],["type","button",1,"btn-nav",3,"click","disabled"],[3,"selectedFlashcards"],[1,"loading-content"],["width","48","height","48","viewBox","0 0 48 48","aria-hidden","true"],["cx","24","cy","24","r","20","stroke","#1976d2","stroke-width","4","fill","none","stroke-linecap","round","stroke-dasharray","31.4 31.4","stroke-dashoffset","0"],["attributeName","transform","type","rotate","from","0 24 24","to","360 24 24","dur","1s","repeatCount","indefinite"],[2,"font-size","1.2rem","color","#444"],[3,"startStudyingCollection"]],template:function(e,n){e&1&&(l(0,"div",0),N(1,Nr,7,0,"div",1),l(2,"header",2)(3,"div",3)(4,"h1"),u(5),g(6,"translate"),c(),ut(7,"app-language-switcher"),c(),l(8,"nav",4)(9,"button",5),C("click",function(){return n.toggleToCollections()}),u(10),g(11,"translate"),c()()(),N(12,Tr,1,0,"app-collections")(13,Br,1,1,"app-selection",6),c()),e&2&&(s(),T(n.isBrowser?-1:1),s(4),m(f(6,9,"flashcards.title")),s(4),H("active",n.currentView()==="flashcards")("disabled",n.currentView()==="collections"),w("disabled",n.currentView()==="collections"),s(),E(" ",f(11,11,"flashcards.collections")," "),s(2),T(n.currentView()==="collections"?12:13))},dependencies:[st,St,Ve,ke,gn,lt],styles:[".spaced-repetition-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:.5rem 1rem;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.spaced-repetition-container[_ngcontent-%COMP%]   .loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#fff;display:flex;align-items:center;justify-content:center;z-index:1000}.spaced-repetition-container[_ngcontent-%COMP%]   .loading-content[_ngcontent-%COMP%]{text-align:center}.header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.header[_ngcontent-%COMP%]   .header-top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem}.header[_ngcontent-%COMP%]   .header-top[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#2c3e50;margin:0;flex:1}.header[_ngcontent-%COMP%]   .header-top[_ngcontent-%COMP%]   app-language-switcher[_ngcontent-%COMP%]{margin-top:.25rem}.header[_ngcontent-%COMP%]   .view-navigation[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:.5rem;margin-bottom:1.5rem}.header[_ngcontent-%COMP%]   .view-navigation[_ngcontent-%COMP%]   .btn-nav[_ngcontent-%COMP%]{padding:.5rem 1rem;border:2px solid #e9ecef;background:#fff;color:#6c757d;border-radius:.5rem;font-weight:500;cursor:pointer;transition:all .3s ease}.header[_ngcontent-%COMP%]   .view-navigation[_ngcontent-%COMP%]   .btn-nav[_ngcontent-%COMP%]:hover:not(.disabled){background:#f8f9fa;border-color:#dee2e6;color:#495057}.header[_ngcontent-%COMP%]   .view-navigation[_ngcontent-%COMP%]   .btn-nav.active[_ngcontent-%COMP%]{background:#007bff;color:#fff;border-color:#007bff}"],changeDetection:0})};export{Xn as FlashcardsComponent};
